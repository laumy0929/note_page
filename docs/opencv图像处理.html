<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>opencvå›¾åƒå¤„ç† - Laumyçš„æŠ€æœ¯æ ˆ</title>
    <link rel="stylesheet" href="assets/style.css">
    <!-- MathJaxæ”¯æŒLaTeXæ•°å­¦å…¬å¼ -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          processEnvironments: true
        },
        options: {
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        }
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="logo" href="./">Laumyçš„æŠ€æœ¯æ ˆ</a>
        <div class="search">
          <input id="search-input" type="text" placeholder="è¾“å…¥å…³é”®è¯å›è½¦æœç´¢">
        </div>
        <div class="theme-toggle" title="åˆ‡æ¢ä¸»é¢˜" id="theme-toggle">â˜¾</div>
        <nav class="top-nav">
          <div class="nav-item"><a href="./">é¦–é¡µ</a></div>
          <div class="nav-item site-link">
            <a href="https://www.laumy.tech" target="_blank" title="è®¿é—®ä¸»ç«™">ä¸»ç«™ç‚¹:www.laumy.tech</a>
          </div>
        </nav>
      </div>
    </header>

    <main class="container layout">
      <aside class="left-nav">
        
        <div class="card">
          <div class="card-title">æ–‡ç« ç›®å½•</div>
          <nav id="toc"><ul><li><a href="#_1">å›¾åƒæ»¤æ³¢</a><ul><li><a href="#_2">å‡å€¼æ»¤æ³¢</a></li><li><a href="#_3">é«˜æ–¯æ»¤æ³¢</a></li><li><a href="#_4">ä¸­å€¼æ»¤æ³¢</a></li><li><a href="#_5">ç¤ºä¾‹</a></li></ul></li><li><a href="#_6">å›¾åƒå½¢æ€å­¦</a><ul><li><a href="#_7">è†¨èƒ€ä¸è…èš€</a></li><li><a href="#_8">é˜ˆå€¼åŒ–</a></li><li><a href="#_9">å¼€é—­è¿ç®—ã€é¡¶å¸½ã€é»‘å¸½</a></li><li><a href="#_10">ç¤ºä¾‹</a></li></ul></li><li><a href="#_11">å›¾åƒè¾¹ç¼˜æ£€æµ‹</a><ul><li><a href="#canny">canny</a></li><li><a href="#_12">éœå¤«å˜æ¢</a></li></ul></li></ul></nav>
        </div>
        
      </aside>

      <section class="content">
        
<article class="card post">
  <h1>opencvå›¾åƒå¤„ç†</h1>
  <div class="meta">
    <span class="meta-item">
      <i class="icon">ğŸ•’</i>
      2025-05-28
    </span>
    <span class="meta-item">
      <i class="icon">ğŸ“‚</i>
      ai
    </span>
    <span class="meta-item">
      <i class="icon">ğŸ‘¤</i>
      laumy
    </span>
  </div>
  <div class="post-content"><h2 id="_1">å›¾åƒæ»¤æ³¢</h2>
<p>å›¾åƒçš„æ»¤æ³¢æ ¸å¿ƒæ˜¯<strong>ä½¿ç”¨ä¸€ä¸ªå°çš„çŸ©é˜µï¼ˆæ»¤æ³¢å™¨æˆ–å·ç§¯æ ¸ï¼‰åœ¨å›¾åƒä¸Šè¿›è¡Œæ»‘åŠ¨å·ç§¯ï¼Œå°†è®¡ç®—å¾—åˆ°çš„ç»“æœä½œä¸ºç›®æ ‡åƒç´ çš„å€¼</strong>ã€‚</p>
<h3 id="_2">å‡å€¼æ»¤æ³¢</h3>
<div class="codehilite"><pre><span></span><code><span class="n">cv</span><span class="o">::</span><span class="n">blur</span><span class="p">(</span><span class="n">InputArray</span><span class="w"> </span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">OutputArray</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">Size</span><span class="w"> </span><span class="n">ksize</span><span class="p">,</span>
<span class="w">         </span><span class="n">Point</span><span class="w"> </span><span class="n">anchor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Point</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span><span class="mi">-1</span><span class="p">),</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">borderType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BORDER_DEFAULT</span><span class="p">);</span>
</code></pre></div>
<ul>
<li>src:è¾“å…¥çš„åŸå§‹å›¾åƒï¼Œæ”¯æŒMatæ ¼å¼</li>
<li>dst:ç»è¿‡æ»¤æ³¢å¤„ç†çš„å›¾åƒ</li>
<li>ksize:æ»¤æ³¢å™¨å¤§å°ï¼Œé€šå¸¸ä¸º2Då¤§å°ï¼Œè¡¨ç¤ºæ»¤æ³¢çš„å®½åº¦å’Œé«˜åº¦ã€‚</li>
<li>anchor:é”šç‚¹æŒ‡å®šçª—å£å†…çš„å‚è€ƒç‚¹ï¼Œé»˜è®¤æ˜¯Point(-1,-1)è¡¨ç¤ºçª—å£ä¸­å¿ƒç‚¹</li>
<li>boarderType:è¾¹ç•Œç±»å‹ï¼Œç”¨æ¥å¤„ç†è¾¹ç•Œå‚æ•°çš„å¤–æ¨æ–¹å¼ã€‚</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">imread</span><span class="p">(</span><span class="s">"image.jpg"</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">IMREAD_GRAYSCALE</span><span class="p">);</span>
<span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">dst</span><span class="p">;</span>
<span class="n">cv</span><span class="o">::</span><span class="n">blur</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span><span class="w">  </span><span class="c1">// 3x3çš„å‡å€¼æ»¤æ³¢</span>
</code></pre></div>
<h3 id="_3">é«˜æ–¯æ»¤æ³¢</h3>
<div class="codehilite"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">cv::GaussianBlur</span><span class="p">(</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="w"> </span><span class="n">ksize</span><span class="p">,</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">sigmaX</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">sigmaY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">borderType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">BORDER_DEFAULT</span><span class="w"> </span><span class="p">);</span>
</code></pre></div>
<ul>
<li>sigmaXï¼šXæ–¹å‘çš„æ ‡å‡†å·®ï¼Œå†³å®šæ¨¡ç³Šçš„ç¨‹åº¦ï¼Œå€¼è¶Šå¤§ï¼Œæ¨¡ç³Šæ•ˆæœè¶Šå¼ºã€‚</li>
<li>sigmaYï¼šYæ–¹å‘çš„æ ‡å‡†å·®ï¼Œé»˜è®¤æ˜¯0ï¼Œè¡¨ç¤ºä¸Xæ–¹å‘ç›¸åŒã€‚</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">cv</span><span class="o">::</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">  </span><span class="c1">// 5x5çš„é«˜æ–¯æ»¤æ³¢</span>
</code></pre></div>
<h3 id="_4">ä¸­å€¼æ»¤æ³¢</h3>
<div class="codehilite"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">medianBlur</span><span class="p">(</span><span class="n">InputArray</span><span class="w"> </span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">OutputArray</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ksize</span><span class="p">);</span>
</code></pre></div>
<ul>
<li>ksizeï¼š æ»¤æ³¢å™¨çª—å£å¤§å°</li>
</ul>
<p>ç¤ºä¾‹</p>
<div class="codehilite"><pre><span></span><code><span class="n">cv</span><span class="o">::</span><span class="n">medianBlur</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w">  </span><span class="c1">// 5x5çš„ä¸­å€¼æ»¤æ³¢</span>
</code></pre></div>
<h3 id="_5">ç¤ºä¾‹</h3>
<p>ä¸‹é¢ç¤ºä¾‹ï¼Œå°†å›¾ç‰‡ä½¿ç”¨é«˜æ–¯å™ªéŸ³å¤„ç†ï¼Œç„¶åå†ä½¿ç”¨æ»¤æ³¢å™¨è¿›è¡Œæ¨¡ç³Šï¼Œå™ªéŸ³å°±å¯ä»¥çœ‹èµ·æ¥è¿‡æ»¤æ‰ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fcntl.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;linux/fb.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;signal.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/ioctl.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;opencv2/opencv.hpp&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">cv</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">add_gaussian_noise</span><span class="p">(</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">stddev</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Mat</span><span class="w"> </span><span class="n">noise</span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">image</span><span class="p">.</span><span class="n">type</span><span class="p">());</span>

<span class="w">    </span><span class="n">randn</span><span class="p">(</span><span class="n">noise</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">stddev</span><span class="p">);</span>

<span class="w">    </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">noise</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">display_image</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">framebuffer_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">720</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ofstream</span><span class="w"> </span><span class="n">ofs</span><span class="p">(</span><span class="s">"/dev/fb0"</span><span class="p">);</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">framebuffer</span><span class="p">;</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">framebuffer</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">COLOR_BGR2BGRA</span><span class="p">);</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Size2f</span><span class="w"> </span><span class="n">frame_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">framebuffer</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">frame_size</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="w"> </span><span class="n">y</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ofs</span><span class="p">.</span><span class="n">seekp</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">framebuffer_width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">        </span><span class="n">ofs</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">framebuffer</span><span class="p">.</span><span class="n">ptr</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span><span class="w"> </span><span class="n">frame_size</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">imread</span><span class="p">(</span><span class="s">"test1.jpg"</span><span class="p">,</span><span class="w"> </span><span class="n">IMREAD_COLOR</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"Error: Could not open or find the image!"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">stddev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">30.0</span><span class="p">;</span>

<span class="w">    </span><span class="n">add_gaussian_noise</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">stddev</span><span class="p">);</span>

<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">image</span><span class="p">);</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">imwrite</span><span class="p">(</span><span class="s">"noise.jpg"</span><span class="p">,</span><span class="w"> </span><span class="n">image</span><span class="p">);</span>

<span class="w">    </span><span class="n">usleep</span><span class="p">(</span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>

<span class="w">    </span><span class="n">Mat</span><span class="w"> </span><span class="n">dst</span><span class="p">;</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="c1">//cv::medianBlur(image, dst, 5);</span>
<span class="w">    </span><span class="c1">//cv::blur(src, dst, cv::Size(3, 3));</span>
<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">imwrite</span><span class="p">(</span><span class="s">"dst.jpg"</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>å¦‚ä¸‹å›¾ï¼Œä¸­é—´æ˜¯åŠ äº†å™ªå£°çš„ï¼Œæœ€åä¸€å¼ æ˜¯é€šè¿‡é«˜æ–¯æ»¤æ³¢å¤„ç†ä¹‹åçš„ã€‚</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2025/05/wp_editor_md_60a334698f29ab4862d1ace5d67329c5.jpg"><img alt="" src="assets/doc/04-ai/opencv/opencvå›¾åƒå¤„ç†/images/wp_editor_md_60a334698f29ab4862d1ace5d67329c5.jpg"/></a></p>
<h2 id="_6">å›¾åƒå½¢æ€å­¦</h2>
<h3 id="_7">è†¨èƒ€ä¸è…èš€</h3>
<p>è†¨èƒ€æ“ä½œä¼šå¢åŠ å›¾åƒä¸­çš„ç™½è‰²åŒºåŸŸæˆ–å‰æ™¯åŒºåŸŸï¼Œä½¿å¾—å›¾åƒä¸­çš„å¯¹è±¡æˆ–ç»“æ„å˜å¾—æ›´å¤§ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒä¼šå°†å›¾åƒä¸­çš„æ¯ä¸ªåƒç´ ç‚¹æ‰©å±•åˆ°å…¶é‚»åŸŸåƒç´ ä¸­ï¼ˆæ ¹æ®ç»“æ„å…ƒç´ çš„å¤§å°å’Œå½¢çŠ¶ï¼‰ã€‚è¿™æ„å‘³ç€å¦‚æœç»“æ„å…ƒç´ çš„ä¸€éƒ¨åˆ†é‡å åœ¨ä¸€ä¸ªå‰æ™¯åŒºåŸŸå†…ï¼Œè¯¥åŒºåŸŸå°±ä¼šè¢«æ‰©å±•ã€‚ä½¿ç™½è‰²åŒºåŸŸæ‰©å±•ï¼Œç‰©ä½“å˜å¤§ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="n">cv2</span><span class="p">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="o">=</span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">,</span><span class="w"> </span><span class="n">anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">),</span><span class="w"> </span><span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">borderType</span><span class="o">=</span><span class="n">cv2</span><span class="p">.</span><span class="n">BORDER_CONSTANT</span><span class="p">,</span><span class="w"> </span><span class="n">borderValue</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<ul>
<li>iterationï¼šè†¨èƒ€è¿­ä»£æ¬¡æ•°ï¼Œè¶Šå¤§æ•ˆæœè¶Šæ˜æ˜¾</li>
<li>borderTypeï¼šè¾¹ç•Œå¡«å……ç±»å‹</li>
<li>borderValueï¼šè¾¹ç•Œå¡«å……å€¼ï¼Œé»˜è®¤0æ˜¯é»‘è‰²</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">MORPH_RECT</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span>
<span class="c1">//åˆ›å»ºä¸€ä¸ª3*3çš„çŸ©å½¢ç»“æ„å…ƒç´ </span>
<span class="n">cv</span><span class="o">::</span><span class="n">dilate</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">);</span>
</code></pre></div>
<p>è…èš€æ“ä½œçš„æ•ˆæœä¸è†¨èƒ€ç›¸åï¼Œå®ƒä¼šå‡å°‘å›¾åƒä¸­çš„ç™½è‰²åŒºåŸŸæˆ–å‰æ™¯åŒºåŸŸï¼Œä½¿å¾—å›¾åƒä¸­çš„å¯¹è±¡å˜å¾—æ›´å°ã€‚è…èš€æ“ä½œä¼šæ£€æŸ¥æ¯ä¸ªåƒç´ çš„é‚»åŸŸï¼Œå¦‚æœé‚»åŸŸå†…çš„æ‰€æœ‰åƒç´ éƒ½æ˜¯å‰æ™¯åƒç´ ï¼ˆç™½è‰²ï¼‰ï¼Œè¯¥åƒç´ æ‰ä¿æŒå‰æ™¯ï¼Œå¦åˆ™å˜ä¸ºèƒŒæ™¯ï¼ˆé»‘è‰²ï¼‰ã€‚ä½¿ç™½è‰²åŒºåŸŸæ”¶ç¼©ï¼Œç‰©ä½“å˜å°ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">MORPH_RECT</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span>
<span class="n">cv</span><span class="o">::</span><span class="n">erode</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">);</span>
</code></pre></div>
<p>ä»¥ä¸‹æ˜¯ç¤ºä¾‹</p>
<div class="codehilite"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fcntl.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fstream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;linux/fb.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;signal.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/ioctl.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;opencv2/opencv.hpp&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">display_image</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span><span class="w"> </span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">framebuffer_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">720</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ofstream</span><span class="w"> </span><span class="n">ofs</span><span class="p">(</span><span class="s">"/dev/fb0"</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ofs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"Error: Could not open framebuffer device!"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">framebuffer</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">channels</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cv</span><span class="o">::</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">framebuffer</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">COLOR_GRAY2BGRA</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">channels</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cv</span><span class="o">::</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">framebuffer</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">COLOR_BGR2BGRA</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">channels</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">image</span><span class="p">.</span><span class="n">copyTo</span><span class="p">(</span><span class="n">framebuffer</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"Error: Unsupported image format!"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Size2f</span><span class="w"> </span><span class="n">frame_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">framebuffer</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">frame_size</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">framebuffer_width</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// è®¡ç®—æ–°çš„å®½é«˜ï¼Œä¿æŒå›¾åƒçš„çºµæ¨ªæ¯”</span>
<span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">aspect_ratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frame_size</span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">frame_size</span><span class="p">.</span><span class="n">width</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">newWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">framebuffer_width</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">newHeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">newWidth</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">aspect_ratio</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// è°ƒæ•´å›¾åƒå¤§å°</span>
<span class="w">        </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">resizedImage</span><span class="p">;</span>
<span class="w">        </span><span class="n">cv</span><span class="o">::</span><span class="n">resize</span><span class="p">(</span><span class="n">framebuffer</span><span class="p">,</span><span class="w"> </span><span class="n">resizedImage</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="p">(</span><span class="n">newWidth</span><span class="p">,</span><span class="w"> </span><span class="n">newHeight</span><span class="p">));</span>
<span class="w">        </span><span class="n">framebuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resizedImage</span><span class="p">;</span>
<span class="w">        </span><span class="n">frame_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resizedImage</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">frame_size</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="w"> </span><span class="n">y</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ofs</span><span class="p">.</span><span class="n">seekp</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">framebuffer_width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">        </span><span class="n">ofs</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">framebuffer</span><span class="p">.</span><span class="n">ptr</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span><span class="w"> </span><span class="n">frame_size</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">imread</span><span class="p">(</span><span class="s">"test1.jpg"</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">IMREAD_COLOR</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"Error: Could not open or find the image!"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">stddev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">30.0</span><span class="p">;</span>

<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">image</span><span class="p">);</span>

<span class="w">    </span><span class="n">usleep</span><span class="p">(</span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">dst</span><span class="p">;</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">MORPH_RECT</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span>

<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">dilate</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">);</span>

<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>

<span class="w">    </span><span class="n">usleep</span><span class="p">(</span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">erode</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">);</span>

<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">dst</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="_8">é˜ˆå€¼åŒ–</h3>
<p>é˜ˆå€¼ï¼ˆThresholdingï¼‰æ˜¯ä¸€ç§å¸¸è§çš„å›¾åƒåˆ†å‰²æ–¹æ³•ï¼Œç”¨äºå°†ç°åº¦å›¾åƒè½¬æ¢ä¸ºäºŒå€¼å›¾åƒã€‚é€šè¿‡è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ï¼Œå°†åƒç´ å€¼é«˜äºè¯¥é˜ˆå€¼çš„åŒºåŸŸè®¾ä¸ºç™½è‰²ï¼ˆ255ï¼‰ï¼Œä½äºé˜ˆå€¼çš„åŒºåŸŸè®¾ä¸ºé»‘è‰²ï¼ˆ0ï¼‰ï¼Œä»è€Œç®€åŒ–å›¾åƒå†…å®¹ï¼Œä¾¿äºåç»­å¤„ç†ã€‚</p>
<p><strong>äºŒå€¼åŒ–é˜ˆå€¼</strong>ï¼šäºŒå€¼åŒ–æ˜¯å°†å›¾åƒä¸­çš„åƒç´ å€¼æ ¹æ®è®¾å®šçš„é˜ˆå€¼åˆ†ä¸ºä¸¤ç±»ï¼Œé€šå¸¸ç”¨äºç®€å•çš„å›¾åƒåˆ†å‰²ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="n">cv</span><span class="o">::</span><span class="n">threshold</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">thresh</span><span class="p">,</span><span class="w"> </span><span class="n">maxval</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">);</span>

<span class="n">ç¤ºä¾‹</span><span class="err">ï¼š</span><span class="n">cv</span><span class="o">::</span><span class="n">threshold</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="mi">127</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">THRESH_BINARY</span><span class="p">);</span>
</code></pre></div>
<ul>
<li>thresh: é˜ˆå€¼ï¼Œå†³å®šåƒç´ åˆ†ç±»çš„åˆ†ç•Œçº¿ã€‚</li>
<li>maxvalï¼šæ ¹æ®typeé€‰æ‹©ï¼Œæ»¡è¶³æ¡ä»¶è®¾ç½®ä¸ºæœ€å¤§å€¼ã€‚</li>
<li>type: é˜ˆå€¼ç±»å‹</li>
</ul>
<p><strong>è‡ªé€‚åº”é˜ˆå€¼</strong>ï¼šæ ¹æ®å›¾åƒçš„å±€éƒ¨åŒºåŸŸåŠ¨æ€è®¡ç®—é˜ˆå€¼ï¼Œé€‚ç”¨äºå…‰ç…§ä¸å‡åŒ€çš„å›¾åƒã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="n">cv</span><span class="o">::</span><span class="n">adaptiveThreshold</span><span class="p">(</span><span class="w"> </span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="n">maxValue</span><span class="p">,</span><span class="w"> </span><span class="n">adaptiveMethod</span><span class="p">,</span>
<span class="w">     </span><span class="n">thresholdType</span><span class="p">,</span><span class="w"> </span><span class="n">blockSize</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">);</span>
</code></pre></div>
<ul>
<li>maxVauleï¼šäºŒå€¼åŒ–çš„æœ€å¤§å€¼ï¼Œä¸€èˆ¬ä¸º255</li>
<li>adaptiveMethodï¼š ADAPTIVE_THRESH_MEAN_Cæ˜¯ä½¿ç”¨é‚»åŸŸçš„å‡å€¼ä½œä¸ºé˜ˆå€¼ï¼ŒADAPTIVE_THRESH_GAUSSIAN_C ï¼šä½¿ç”¨é‚»åŸŸçš„åŠ æƒå‡å€¼ï¼ˆé«˜æ–¯åŠ æƒï¼‰ä½œä¸ºé˜ˆå€¼ã€‚</li>
<li>thresholdTypeï¼šé˜ˆå€¼ç±»å‹ï¼Œé€šå¸¸ä½¿ç”¨ THRESH_BINARY æˆ– THRESH_BINARY_INVã€‚</li>
<li>blockSizeï¼šé‚»åŸŸçš„å¤§å°ï¼Œå¿…é¡»æ˜¯å¥‡æ•°ï¼ˆä¾‹å¦‚ 3 , 5 , 7 , ...ï¼‰ï¼Œè¯¥çª—å£åœ¨å›¾åƒä¸Šæ»‘åŠ¨ã€‚</li>
<li>Cï¼šè°ƒæ•´å€¼ï¼Œç”¨äºä»è®¡ç®—çš„é˜ˆå€¼ä¸­å‡å»ã€‚è°ƒæ•´ç»“æœçš„çµæ•åº¦ã€‚</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="n">cv</span><span class="o">::</span><span class="n">adaptiveThreshold</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span>
<span class="w">        </span><span class="n">cv</span><span class="o">::</span><span class="n">ADAPTIVE_THRESH_MEAN_C</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">THRESH_BINARY</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</code></pre></div>
<h3 id="_9">å¼€é—­è¿ç®—ã€é¡¶å¸½ã€é»‘å¸½</h3>
<ul>
<li>å¼€è¿ç®—ï¼šå¼€è¿ç®—æ˜¯å…ˆè¿›è¡Œè…èš€æ“ä½œå†è¿›è¡Œè†¨èƒ€æ“ä½œã€‚å®ƒé€šå¸¸ç”¨äºå»é™¤å°çš„å™ªç‚¹æˆ–å°çš„ç‰©ä½“ï¼ŒåŒæ—¶ä¿ç•™è¾ƒå¤§åŒºåŸŸçš„ç»“æ„ã€‚</li>
<li>é—­è¿ç®—ï¼šé—­è¿ç®—æ˜¯å…ˆè¿›è¡Œè†¨èƒ€æ“ä½œå†è¿›è¡Œè…èš€æ“ä½œã€‚å®ƒç”¨äºå»é™¤å°çš„é»‘è‰²åŒºåŸŸï¼ˆå¦‚å°å­”æ´æˆ–ç©ºéš™ï¼‰ï¼Œå¹¶è¿æ¥ç‰©ä½“ä¹‹é—´çš„ç»†å°è£‚ç¼ã€‚</li>
<li>é¡¶å¸½ï¼šé¡¶å¸½æ˜¯å¼€è¿ç®—çš„ç»“æœä¸åŸå›¾åƒä¹‹é—´çš„å·®å¼‚ï¼Œä¸»è¦ç”¨äºæå–æ¯”èƒŒæ™¯æ›´äº®çš„åŒºåŸŸæˆ–å°çš„äº®ç‚¹ã€‚</li>
<li>é»‘å¸½ï¼šé»‘å¸½æ˜¯é—­è¿ç®—çš„ç»“æœä¸åŸå›¾åƒä¹‹é—´çš„å·®å¼‚ï¼Œä¸»è¦ç”¨äºæå–æ¯”èƒŒæ™¯æ›´æš—çš„åŒºåŸŸæˆ–å°çš„æš—ç‚¹ã€‚</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">cv::morphologyEx</span><span class="p">(</span><span class="w"> </span><span class="n">InputArray</span><span class="w"> </span><span class="n">src</span><span class="p">,</span><span class="w">  </span><span class="n">OutputArray</span><span class="w"> </span><span class="n">dst</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">op</span><span class="p">,</span>
<span class="w">    </span><span class="n">InputArray</span><span class="w"> </span><span class="n">kernel</span><span class="p">,</span><span class="w"> </span><span class="n">Point</span><span class="w"> </span><span class="n">anchor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Point</span><span class="p">(</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">),</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">iterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">borderType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BORDER_CONSTANT</span><span class="p">,</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">Scalar</span><span class="o">&amp;</span><span class="n">borderValue</span><span class="o">=</span><span class="n">morphologyDefaultBorderValue</span><span class="p">()</span><span class="w">  </span><span class="p">);</span>
</code></pre></div>
<ul>
<li>kernelï¼šç»“æ„å…ƒç´ ï¼Œé€šå¸¸ä½¿ç”¨ cv::getStructuringElement() ç”Ÿæˆã€‚</li>
<li>op:å½¢æ€å­¦æ“ä½œç±»å‹ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯opçš„ç±»å‹</p>
<ul>
<li>cv:MORPH_OPENï¼šå¼€è¿ç®—ã€‚</li>
<li>cv::MORPH_CLOSEï¼šé—­è¿ç®—ã€‚</li>
<li>cv::MORPH_GRADIENT: å½¢æ€å­¦æ¢¯åº¦ï¼ˆè†¨èƒ€ - è…èš€ï¼‰ï¼Œæå–ç‰©ä½“è¾¹ç¼˜ã€‚</li>
<li>cv::MORPH_TOPHAT :é¡¶å¸½è¿ç®—ï¼ˆåŸå›¾ - å¼€è¿ç®—ç»“æœï¼‰ï¼Œæå–æ¯”èƒŒæ™¯äº®çš„åŒºåŸŸã€‚</li>
<li>cv::MORPH_BLACKHAT é»‘å¸½è¿ç®—ï¼ˆé—­è¿ç®—ç»“æœ - åŸå›¾ï¼‰ï¼Œæå–æ¯”èƒŒæ™¯æš—çš„åŒºåŸŸã€‚</li>
</ul>
<h3 id="_10">ç¤ºä¾‹</h3>
<p>ç¤ºä¾‹ç¨‹åºå¦‚ä¸‹ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">imread</span><span class="p">(</span><span class="s">"test1.jpg"</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">IMREAD_GRAYSCALE</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"Error: Could not open or find the image!"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">binary_img</span><span class="p">;</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">threshold</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">binary_img</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">THRESH_BINARY</span><span class="p">);</span>

<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">cv</span><span class="o">::</span><span class="n">MORPH_RECT</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Size</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span>

<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">dst</span><span class="p">;</span>

<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">opened_img</span><span class="p">,</span><span class="w"> </span><span class="n">closed_img</span><span class="p">,</span><span class="w"> </span><span class="n">tophat_img</span><span class="p">,</span><span class="w"> </span><span class="n">blackhat_img</span><span class="p">;</span>

<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">binary_img</span><span class="p">,</span><span class="w"> </span><span class="n">opened_img</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">MORPH_OPEN</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">);</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">binary_img</span><span class="p">,</span><span class="w"> </span><span class="n">closed_img</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">MORPH_CLOSE</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">);</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">binary_img</span><span class="p">,</span><span class="w"> </span><span class="n">tophat_img</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">MORPH_TOPHAT</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">);</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">binary_img</span><span class="p">,</span><span class="w"> </span><span class="n">blackhat_img</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">MORPH_BLACKHAT</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="p">);</span>

<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">image</span><span class="p">);</span>
<span class="w">    </span><span class="n">usleep</span><span class="p">(</span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">binary_img</span><span class="p">);</span>
<span class="w">    </span><span class="n">usleep</span><span class="p">(</span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">closed_img</span><span class="p">);</span>
<span class="w">    </span><span class="n">usleep</span><span class="p">(</span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">tophat_img</span><span class="p">);</span>
<span class="w">    </span><span class="n">usleep</span><span class="p">(</span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">blackhat_img</span><span class="p">);</span>

<span class="p">}</span>
</code></pre></div>
<p><a href="https://www.laumy.tech/wp-content/uploads/2025/05/wp_editor_md_4d1a022fc3bfa4765c2c4a367834992f.jpg"><img alt="" src="assets/doc/04-ai/opencv/opencvå›¾åƒå¤„ç†/images/wp_editor_md_4d1a022fc3bfa4765c2c4a367834992f.jpg"/></a></p>
<h2 id="_11">å›¾åƒè¾¹ç¼˜æ£€æµ‹</h2>
<h3 id="canny">canny</h3>
<p>Cannyè¾¹ç¼˜æ£€æµ‹æ˜¯ä¸€ä¸ªå¤šé˜¶æ®µçš„å›¾åƒå¤„ç†ç®—æ³•ï¼Œç”¨äºæå–å›¾åƒä¸­çš„è¾¹ç¼˜ã€‚å®ƒçš„ç›®æ ‡æ˜¯è¯†åˆ«å›¾åƒä¸­å¼ºåº¦å˜åŒ–è¾ƒå¤§çš„åŒºåŸŸï¼Œå³è¾¹ç¼˜</p>
<div class="codehilite"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">imread</span><span class="p">(</span><span class="s">"test1.jpg"</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">IMREAD_GRAYSCALE</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"Error: Could not open image!"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// è¿›è¡Œ Canny è¾¹ç¼˜æ£€æµ‹</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">edges</span><span class="p">;</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Canny</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">);</span><span class="w"> </span><span class="c1">// ä½é˜ˆå€¼ 100ï¼Œé«˜é˜ˆå€¼ 200</span>
<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">edges</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>ä¸‹é¢æ˜¯å¤„ç†çš„å‰åæ•ˆæœã€‚</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2025/05/wp_editor_md_a622ce4a43591be2e6486d0a3798328d.jpg"><img alt="" src="assets/doc/04-ai/opencv/opencvå›¾åƒå¤„ç†/images/wp_editor_md_a622ce4a43591be2e6486d0a3798328d.jpg"/></a></p>
<h3 id="_12">éœå¤«å˜æ¢</h3>
<p>éœå¤«å˜æ¢ï¼ˆHough Transformï¼‰æ˜¯ä¸€ç§ç”¨äºæ£€æµ‹å›¾åƒä¸­çš„å‡ ä½•å½¢çŠ¶ï¼ˆå¦‚ç›´çº¿ã€åœ†ç­‰ï¼‰çš„æ–¹æ³•ã€‚å®ƒä¸»è¦ç”¨äºå›¾åƒä¸­çš„ç‰¹å¾æ£€æµ‹ï¼Œç‰¹åˆ«æ˜¯åœ¨å™ªå£°è¾ƒå¤§çš„å›¾åƒä¸­ï¼Œå¯ä»¥æœ‰æ•ˆåœ°è¿›è¡Œå½¢çŠ¶çš„è¯†åˆ«ã€‚éœå¤«å˜æ¢çš„åŸºæœ¬æ€æƒ³æ˜¯å°†å›¾åƒä¸­çš„è¾¹ç¼˜ç‚¹é€šè¿‡ä¸€ç§æ•°å­¦æ˜ å°„ï¼Œè½¬åŒ–åˆ°å‚æ•°ç©ºé—´ï¼Œç„¶ååœ¨å‚æ•°ç©ºé—´ä¸­å¯»æ‰¾å¯¹åº”çš„æ›²çº¿ï¼ˆæˆ–ç›´çº¿ã€åœ†ç­‰ï¼‰ã€‚</p>
<p><strong>éœå¤«çº¿å˜æ¢</strong>ï¼š æ£€æµ‹çº¿ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="n">cv2</span><span class="p">.</span><span class="n">HoughLinesP</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">threshold</span><span class="p">,</span><span class="w"> </span><span class="n">minLineLength</span><span class="p">,</span><span class="w"> </span><span class="n">maxLineGap</span><span class="p">)</span>
</code></pre></div>
<ul>
<li>image: è¾“å…¥å›¾åƒï¼Œé€šå¸¸æ˜¯ç»è¿‡è¾¹ç¼˜æ£€æµ‹ï¼ˆå¦‚ Canny è¾¹ç¼˜æ£€æµ‹ï¼‰åçš„äºŒå€¼å›¾åƒã€‚</li>
<li>rho: ç›´çº¿è·ç¦»ç²¾åº¦ï¼Œå•ä½æ˜¯åƒç´ ï¼Œé€šå¸¸è®¾ç½®ä¸º 1ã€‚</li>
<li>theta: è§’åº¦ç²¾åº¦ï¼Œå•ä½æ˜¯å¼§åº¦ï¼Œé€šå¸¸è®¾ç½®ä¸º np.pi / 180ï¼ˆå³ 1Â°ï¼‰ã€‚</li>
<li>threshold: æœ€å°æŠ•ç¥¨æ•°ï¼Œå½“æŸä¸€å€™é€‰ç›´çº¿åœ¨å‚æ•°ç©ºé—´ä¸­çš„æŠ•ç¥¨æ•°å¤§äºæ­¤é˜ˆå€¼æ—¶ï¼Œè®¤ä¸ºæ£€æµ‹åˆ°ç›´çº¿ã€‚</li>
<li>minLineLength: æœ€å°ç›´çº¿é•¿åº¦ã€‚åªæœ‰é•¿åº¦å¤§äºè¯¥å€¼çš„ç›´çº¿æ‰ä¼šè¢«è¿”å›ã€‚</li>
<li>maxLineGap: æœ€å¤§ç›´çº¿é—´éš™ã€‚å¦‚æœä¸¤æ®µç›´çº¿ä¹‹é—´çš„é—´éš™å°äºè¯¥å€¼ï¼Œåˆ™è®¤ä¸ºå®ƒä»¬æ˜¯åŒä¸€æ¡ç›´çº¿çš„ä¸¤éƒ¨åˆ†</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">img</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">imread</span><span class="p">(</span><span class="s">"test1.jpg"</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">img</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"Error: Could not open image!"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// å›¾åƒé¢„å¤„ç†ï¼šè¾¹ç¼˜æ£€æµ‹</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">edges</span><span class="p">;</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Canny</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="w"> </span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">150</span><span class="p">);</span><span class="w">  </span><span class="c1">// ä½¿ç”¨ Canny è¾¹ç¼˜æ£€æµ‹</span>

<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">edges</span><span class="p">);</span>

<span class="w">    </span><span class="n">usleep</span><span class="p">(</span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// ä½¿ç”¨ HoughLinesP è¿›è¡Œéœå¤«å˜æ¢ï¼ˆæ¦‚ç‡éœå¤«å˜æ¢ï¼‰</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">Vec4i</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lines</span><span class="p">;</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">HoughLinesP</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="n">lines</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">CV_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span><span class="w">  </span><span class="c1">// å‚æ•°ä¸º (è¾¹ç¼˜å›¾åƒ, è¾“å‡ºçš„ç›´çº¿, Ïç²¾åº¦, Î¸ç²¾åº¦, é˜ˆå€¼, æœ€å°çº¿æ®µé•¿åº¦, æœ€å¤§çº¿æ®µé—´éš™)</span>

<span class="w">    </span><span class="c1">// ç»˜åˆ¶æ£€æµ‹åˆ°çš„ç›´çº¿</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">img</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
<span class="w">    </span><span class="c1">//cv::cvtColor(result, result, cv::COLOR_GRAY2BGR);  // å°†ç°åº¦å›¾è½¬ä¸ºå½©è‰²å›¾ä»¥æ˜¾ç¤ºå½©è‰²ç›´çº¿</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">lines</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cv</span><span class="o">::</span><span class="n">Vec4i</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">        </span><span class="n">cv</span><span class="o">::</span><span class="n">line</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Point</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="w"> </span>
<span class="w">            </span><span class="n">cv</span><span class="o">::</span><span class="n">Point</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Scalar</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w">  </span><span class="c1">// ç»˜åˆ¶ç›´çº¿</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå…ˆä½¿ç”¨cannyè¿›è¡Œè¾¹ç¼˜å¤„ç†ï¼Œç„¶åé€å…¥åˆ°éœå¤«å˜æ¢ä¸­è¿›è¡Œæ£€æµ‹ï¼Œæœ€åç»˜åˆ¶æˆç›´çº¿ã€‚ä¸‹é¢æ˜¯æ£€æµ‹åçš„æ•ˆæœã€‚</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2025/05/wp_editor_md_72fba2bbfb0f2a1baa00d06d002b8258.jpg"><img alt="" src="assets/doc/04-ai/opencv/opencvå›¾åƒå¤„ç†/images/wp_editor_md_72fba2bbfb0f2a1baa00d06d002b8258.jpg"/></a></p>
<p><strong>éœå¤«åœ†å˜æ¢</strong>ï¼š æ£€æµ‹åœ†ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="n">cv2</span><span class="p">.</span><span class="n">HoughCircles</span><span class="p">(</span><span class="n">image</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">minDist</span><span class="p">,</span><span class="w"> </span><span class="n">param1</span><span class="p">,</span><span class="w"> </span><span class="n">param2</span><span class="p">,</span><span class="w"> </span><span class="n">minRadius</span><span class="p">,</span><span class="w"> </span><span class="n">maxRadius</span><span class="p">)</span>
</code></pre></div>
<ul>
<li>image: è¾“å…¥å›¾åƒï¼Œé€šå¸¸æ˜¯ç°åº¦å›¾åƒã€‚</li>
<li>method: éœå¤«å˜æ¢çš„æ£€æµ‹æ–¹æ³•ã€‚å¯¹äº HoughCirclesï¼Œä¸€èˆ¬ä½¿ç”¨ cv2.HOUGH_GRADIENTã€‚</li>
<li>dp: åˆ†è¾¨ç‡åæ¯”ï¼Œè¡¨ç¤ºéœå¤«ç©ºé—´çš„åˆ†è¾¨ç‡ä¸å›¾åƒåˆ†è¾¨ç‡çš„æ¯”ä¾‹ã€‚é€šå¸¸è®¾ç½®ä¸º 1ã€‚</li>
<li>minDist: è®¾å®šåœ†å¿ƒä¹‹é—´çš„æœ€å°è·ç¦»ï¼Œé˜²æ­¢æ£€æµ‹åˆ°ç›¸äº’é å¾—å¤ªè¿‘çš„åœ†ã€‚</li>
<li>param1: è¾¹ç¼˜æ£€æµ‹çš„é«˜é˜ˆå€¼ï¼ˆCanny è¾¹ç¼˜æ£€æµ‹çš„é«˜é˜ˆå€¼ï¼‰ã€‚</li>
<li>param2: åœ†çš„ä¸­å¿ƒæ£€æµ‹é˜ˆå€¼ï¼Œè¾ƒå°çš„å€¼ä¼šæ£€æµ‹åˆ°æ›´å¤šçš„åœ†ï¼Œè¾ƒå¤§çš„å€¼ä¼šæ£€æµ‹è¾ƒå°‘çš„åœ†ã€‚</li>
<li>minRadius: æœ€å°åœ†åŠå¾„ï¼ˆå•ä½ï¼šåƒç´ ï¼‰ã€‚</li>
<li>maxRadius: æœ€å¤§åœ†åŠå¾„ï¼ˆå•ä½ï¼šåƒç´ ï¼‰ã€‚</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">img</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">imread</span><span class="p">(</span><span class="s">"test1.jpg"</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">img</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">"Error: Could not open image!"</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// è¿›è¡Œè¾¹ç¼˜æ£€æµ‹</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">edges</span><span class="p">;</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Canny</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="w"> </span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">150</span><span class="p">);</span>

<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">edges</span><span class="p">);</span>
<span class="w">    </span><span class="n">usleep</span><span class="p">(</span><span class="mi">1000</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// å­˜å‚¨æ£€æµ‹åˆ°çš„åœ†</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cv</span><span class="o">::</span><span class="n">Vec3f</span><span class="o">&gt;</span><span class="w"> </span><span class="n">circles</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// ä½¿ç”¨éœå¤«åœ†å˜æ¢æ£€æµ‹åœ†</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">HoughCircles</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="n">circles</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">HOUGH_GRADIENT</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w"> </span><span class="mi">27</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// åœ¨åŸå›¾ä¸Šç»˜åˆ¶æ£€æµ‹åˆ°çš„åœ†</span>
<span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">img</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">circles</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cv</span><span class="o">::</span><span class="n">Point</span><span class="w"> </span><span class="n">center</span><span class="p">(</span><span class="n">cvRound</span><span class="p">(</span><span class="n">circles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="w"> </span><span class="n">cvRound</span><span class="p">(</span><span class="n">circles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]));</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cvRound</span><span class="p">(</span><span class="n">circles</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]);</span>
<span class="w">        </span><span class="c1">// ç»˜åˆ¶åœ†å¿ƒ</span>
<span class="w">        </span><span class="n">cv</span><span class="o">::</span><span class="n">circle</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">center</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Scalar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<span class="w">        </span><span class="c1">// ç»˜åˆ¶åœ†</span>
<span class="w">        </span><span class="n">cv</span><span class="o">::</span><span class="n">circle</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">center</span><span class="p">,</span><span class="w"> </span><span class="n">radius</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">::</span><span class="n">Scalar</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">display_image</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>åŒæ ·æ˜¯å…ˆä½¿ç”¨cannyæ£€æµ‹è¿›è¡Œå¤„ç†ï¼Œç„¶åå†ä½¿ç”¨éœå¤«åœ†è¿›è¡Œæ£€æµ‹åœ†ï¼Œæœ€åè¯•ç”¨cv::circleè¿›è¡Œç»˜åˆ¶ã€‚</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2025/05/wp_editor_md_54cd04d254a6dabd481f68fc9b382123.jpg"><img alt="" src="assets/doc/04-ai/opencv/opencvå›¾åƒå¤„ç†/images/wp_editor_md_54cd04d254a6dabd481f68fc9b382123.jpg"/></a></p></div>
  <div class="post-nav">
    <a class="prev" href="å…¨è¿æ¥å±‚ä¸å·ç§¯å±‚å‚æ•°è®¡ç®—.html">â† å…¨è¿æ¥å±‚ä¸å·ç§¯å±‚å‚æ•°è®¡ç®—</a>
    <a class="next" href="opencvè§†é¢‘æµ.html">opencvè§†é¢‘æµ â†’</a>
  </div>
</article>

      </section>

      <aside class="right-panel">
        
      </aside>
    </main>

    <footer class="site-footer">
      <div class="container">Copyright Â©2022-2025 laumy ç‰ˆæƒæ‰€æœ‰</div>
    </footer>

    <script src="assets/site.js"></script>
  </body>
  </html>


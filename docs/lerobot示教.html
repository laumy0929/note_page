<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>lerobotç¤ºæ•™ - Laumyçš„æŠ€æœ¯æ ˆ</title>
    <link rel="stylesheet" href="assets/style.css">
    <!-- MathJaxæ”¯æŒLaTeXæ•°å­¦å…¬å¼ -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          processEnvironments: true
        },
        options: {
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        }
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="logo" href="./">Laumyçš„æŠ€æœ¯æ ˆ</a>
        <div class="search">
          <input id="search-input" type="text" placeholder="è¾“å…¥å…³é”®è¯å›è½¦æœç´¢">
        </div>
        <div class="theme-toggle" title="åˆ‡æ¢ä¸»é¢˜" id="theme-toggle">â˜¾</div>
        <nav class="top-nav">
          <div class="nav-item"><a href="./">é¦–é¡µ</a></div>
          <div class="nav-item site-link">
            <a href="https://www.laumy.tech" target="_blank" title="è®¿é—®ä¸»ç«™">ä¸»ç«™ç‚¹:www.laumy.tech</a>
          </div>
        </nav>
      </div>
    </header>

    <main class="container layout">
      <aside class="left-nav">
        
        <div class="card">
          <div class="card-title">æ–‡ç« ç›®å½•</div>
          <nav id="toc"><ul><li><a href="#_1">å¯åŠ¨</a><ul></ul></li><li><a href="#_2">é…ç½®è§£æ</a><ul></ul></li><li><a href="#_3">åˆå§‹åŒ–å¯è§†åŒ–å·¥å…·</a><ul></ul></li><li><a href="#_4">åˆ›å»ºä¸»ä»è‡‚å®ä¾‹</a><ul></ul></li><li><a href="#_5">è¿æ¥è®¾å¤‡</a><ul></ul></li><li><a href="#_6">è·Ÿéšæ§åˆ¶</a><ul></ul></li></ul></nav>
        </div>
        
      </aside>

      <section class="content">
        
<article class="card post">
  <h1>lerobotç¤ºæ•™</h1>
  <div class="meta">
    <span class="meta-item">
      <i class="icon">ğŸ•’</i>
      2025-07-28
    </span>
    <span class="meta-item">
      <i class="icon">ğŸ“‚</i>
      ai
    </span>
    <span class="meta-item">
      <i class="icon">ğŸ‘¤</i>
      laumy
    </span>
  </div>
  <div class="post-content"><h2 id="_1">å¯åŠ¨</h2>
<p>ç¤ºæ•™çš„åŠŸèƒ½ä¸»è¦æ˜¯ä¸»è‡‚æ§åˆ¶ï¼Œä»è‡‚è·Ÿéšï¼Œåœ¨æ•°æ®é‡‡é›†æ˜¯éå¸¸çš„ä¸€ç¯ã€‚ä¸‹é¢æ˜¯æ¨¡å—å¯åŠ¨çš„æ‰§è¡Œå‘½ä»¤ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">teleoperate</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span> \
  <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_leader</span> \
  <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM1</span> \
  <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R07252608</span>
</code></pre></div>
<p>pythonè§£é‡Šå™¨å›å®‰è£…sys.pathæŸ¥æ‰¾lerobot.teleoperateæ¨¡å—ï¼Œæ‰¾åˆ°æ‰§è¡Œlerobot/src/lerobot/teleoperate.pyæ–‡ä»¶ï¼Œè°ƒç”¨teleoperateå‡½æ•°ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="c1">## é…ç½®è§£æ</span>
<span class="nd">@draccus</span><span class="o">.</span><span class="n">wrap</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">teleoperate</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">TeleoperateConfig</span><span class="p">):</span>
    <span class="n">init_logging</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">pformat</span><span class="p">(</span><span class="n">asdict</span><span class="p">(</span><span class="n">cfg</span><span class="p">)))</span>
<span class="c1">## åˆå§‹åŒ–å¯è§†åŒ–å·¥å…·</span>
    <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">display_data</span><span class="p">:</span>
        <span class="n">_init_rerun</span><span class="p">(</span><span class="n">session_name</span><span class="o">=</span><span class="s2">"teleoperation"</span><span class="p">)</span>
<span class="c1">##åˆ›å»ºæ“ä½œè®¾å¤‡å’Œæœºå™¨äººå®ä¾‹</span>
    <span class="n">teleop</span> <span class="o">=</span> <span class="n">make_teleoperator_from_config</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">teleop</span><span class="p">)</span>
    <span class="n">robot</span> <span class="o">=</span> <span class="n">make_robot_from_config</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">robot</span><span class="p">)</span>
<span class="c1">## è¿æ¥è®¾å¤‡</span>
    <span class="n">teleop</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">robot</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="c1">##ç¤ºæ•™å¾ªç¯</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">teleop_loop</span><span class="p">(</span><span class="n">teleop</span><span class="p">,</span> <span class="n">robot</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span> <span class="n">display_data</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">display_data</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">teleop_time_s</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">display_data</span><span class="p">:</span>
            <span class="n">rr</span><span class="o">.</span><span class="n">rerun_shutdown</span><span class="p">()</span>
<span class="c1">## æ–­å¼€è¿æ¥</span>
        <span class="n">teleop</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="n">robot</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="n">teleoperate</span><span class="p">()</span>
</code></pre></div>
<p>ä¸‹é¢å±•å¼€æ¥è¯´æ˜ä¸€ä¸‹ã€‚</p>
<h2 id="_2">é…ç½®è§£æ</h2>
<div class="codehilite"><pre><span></span><code><span class="nd">@draccus</span><span class="o">.</span><span class="n">wrap</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">teleoperate</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">TeleoperateConfig</span><span class="p">):</span>
    <span class="c1"># åˆå§‹åŒ–æ—¥å¿—è®°å½•</span>
    <span class="n">init_logging</span><span class="p">()</span>
    <span class="c1"># æ‰“å°é…ç½®ä¿¡æ¯</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">pformat</span><span class="p">(</span><span class="n">draccus</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="n">cfg</span><span class="p">)))</span>
</code></pre></div>
<p>åœ¨teleoperate.pyä¸­teleoperateå‡½æ•°ä½¿ç”¨@draccus.wrap()è£…é¥°å™¨è§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œå°†å‚æ•°è½¬æ¢ä¸ºTeleoperateConfigç±»å‹çš„é…ç½®å¯¹è±¡ã€‚dracusæ˜¯ç”¨äºé…ç½®è§£æçš„åº“ï¼Œç±»å‹ä¸argparseã€‚</p>
<p>è¿™é‡Œçš„TeleoperateConfigæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„é…ç½®ç±»ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">RobotConfig</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">str</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TeleopConfig</span><span class="p">:</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">str</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TeleoperateConfig</span><span class="p">:</span>
    <span class="n">teleop</span><span class="p">:</span> <span class="n">TeleoperatorConfig</span>
    <span class="n">robot</span><span class="p">:</span> <span class="n">RobotConfig</span>
    <span class="c1"># Limit the maximum frames per second.</span>
    <span class="n">fps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">teleop_time_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Display all cameras on screen</span>
    <span class="n">display_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
<p>å¯ä»¥çœ‹åˆ°TeleoperateConfigç±»ä¸­å±æ€§å®šä¹‰äº†robotï¼Œteleopä¸¤ä¸ªå¯¹è±¡ï¼Œå‘½ä»¤è¡Œçš„å‚æ•°å°†ä¼šæ˜ å°„åˆ°ï¼Œå¦‚ï¼š</p>
<ul>
<li>--robot.type=so101_followerï¼šå¯¹åº”cfg.robot.type</li>
<li>--teleop.port=/dev/ttyACM1:å¯¹åº”cfg.teleop.port</li>
</ul>
<h2 id="_3">åˆå§‹åŒ–å¯è§†åŒ–å·¥å…·</h2>
<div class="codehilite"><pre><span></span><code>    <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">display_data</span><span class="p">:</span>
        <span class="n">_init_rerun</span><span class="p">(</span><span class="n">session_name</span><span class="o">=</span><span class="s2">"teleoperation"</span><span class="p">)</span>
</code></pre></div>
<p>å½“å‚æ•°--display_data=trueï¼Œå³cfg.display_data ä¸º Trueï¼Œåˆ™è°ƒç”¨ _init_rerun å‡½æ•°åˆå§‹åŒ– rerun å¯è§†åŒ–å·¥å…·ã€‚rerun æ˜¯ä¸€ä¸ªç”¨äºè®°å½•å’Œå¯è§†åŒ–ç§‘å­¦æ•°æ®çš„å·¥å…·ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">_init_rerun</span><span class="p">(</span><span class="n">session_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"lerobot_control_loop"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Initializes the Rerun SDK for visualizing the control loop."""</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"RERUN_FLUSH_NUM_BYTES"</span><span class="p">,</span> <span class="s2">"8000"</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"RERUN_FLUSH_NUM_BYTES"</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch_size</span>
    <span class="n">rr</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">session_name</span><span class="p">)</span>
    <span class="n">memory_limit</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">"LEROBOT_RERUN_MEMORY_LIMIT"</span><span class="p">,</span> <span class="s2">"10%"</span><span class="p">)</span>
    <span class="n">rr</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="n">memory_limit</span><span class="o">=</span><span class="n">memory_limit</span><span class="p">)</span>
</code></pre></div>
<p>_init_rerunå‡½æ•°çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆå§‹åŒ–Rerun SDK,è®¾ç½®æ•°æ®åˆ·æ–°çš„å­—èŠ‚æ•°å’Œå†…å­˜ä½¿ç”¨é™åˆ¶ï¼Œç„¶åå¯åŠ¨Rerunä¼šè¯ï¼Œä¸ºåç»­çš„æ§åˆ¶å¾ªç¯å¯è§†åŒ–å·¥ä½œåšå‡†å¤‡ã€‚</p>
<p>å…¶ä¸­æœ‰ä¸¤ä¸ªå‚æ•°æ˜¯ä»ç¯å¢ƒå˜é‡ä¸­è·å–ï¼Œåˆ†åˆ«æ˜¯RERUN_FLUSH_NUM_BYTESå’ŒLEROBOT_RERUN_MEMORY_LIMITï¼Œç”¨äºæ§åˆ¶æ¯æ¬¡åˆ·æ–°æ˜¯å¤„ç†æ•°æ®çš„å­—èŠ‚æ•°å’Œé™åˆ¶ä½¿ç”¨çš„å†…å­˜é‡ã€‚</p>
<h2 id="_4">åˆ›å»ºä¸»ä»è‡‚å®ä¾‹</h2>
<div class="codehilite"><pre><span></span><code><span class="n">teleop</span> <span class="o">=</span> <span class="n">make_teleoperator_from_config</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">teleop</span><span class="p">)</span>
<span class="n">robot</span> <span class="o">=</span> <span class="n">make_robot_from_config</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">robot</span><span class="p">)</span>
</code></pre></div>
<p>è°ƒç”¨è°ƒç”¨ make_teleoperator_from_config å’Œmake_robot_from_config å‡½æ•°ï¼Œæ ¹æ®é…ç½®å¯¹è±¡åˆ›å»º SO101Leaderé¥æ“ä½œè®¾å¤‡å®ä¾‹å’Œ SO101Follower æœºå™¨äººå®ä¾‹ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">make_teleoperator_from_config</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">TeleoperatorConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Teleoperator</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">"keyboard"</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.keyboard</span> <span class="kn">import</span> <span class="n">KeyboardTeleop</span>

        <span class="k">return</span> <span class="n">KeyboardTeleop</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">"koch_leader"</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.koch_leader</span> <span class="kn">import</span> <span class="n">KochLeader</span>

        <span class="k">return</span> <span class="n">KochLeader</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">"so100_leader"</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.so100_leader</span> <span class="kn">import</span> <span class="n">SO100Leader</span>

        <span class="k">return</span> <span class="n">SO100Leader</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">"so101_leader"</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.so101_leader</span> <span class="kn">import</span> <span class="n">SO101Leader</span>

        <span class="k">return</span> <span class="n">SO101Leader</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="o">......</span>
</code></pre></div>
<p>ä»¥leaderä¸ºä¾‹ï¼Œæœ€ç»ˆè°ƒç”¨SO101Leaderå¯¹è±¡å®ä¾‹ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">SO101Leader</span><span class="p">(</span><span class="n">Teleoperator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    SO-101 Leader Arm designed by TheRobotStudio and Hugging Face.</span>
<span class="sd">    """</span>

    <span class="n">config_class</span> <span class="o">=</span> <span class="n">SO101LeaderConfig</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">"so101_leader"</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">SO101LeaderConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="c1">#è°ƒç”¨çˆ¶ç±»Teleoperatorå¤Ÿç€å‡½æ•°åˆå§‹åŒ–å±æ€§ï¼ŒåŒ…æ‹¬</span>
        <span class="c1">#self.idï¼šè®¾å¤‡çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä»é…ç½®å¯¹è±¡ä¸­è·å–ã€‚</span>
        <span class="c1">#self.calibration_dirï¼šæ ¡å‡†æ–‡ä»¶çš„å­˜å‚¨ç›®å½•ã€‚</span>
        <span class="c1">#self.calibration_fpathï¼šæ ¡å‡†æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚</span>
        <span class="c1">#self.calibrationï¼šå­˜å‚¨ç”µæœºæ ¡å‡†ä¿¡æ¯çš„å­—å…¸ã€‚</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="c1">#ç±»å‹ä¸º SO101LeaderConfigï¼Œå­˜å‚¨ä¼ å…¥çš„é…ç½®å¯¹è±¡ï¼Œæ–¹ä¾¿åœ¨ç±»çš„å…¶ä»–æ–¹æ³•ä¸­è®¿é—®é…ç½®ä¿¡æ¯ã€‚</span>
        <span class="n">norm_mode_body</span> <span class="o">=</span> <span class="n">MotorNormMode</span><span class="o">.</span><span class="n">DEGREES</span> <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_degrees</span> <span class="k">else</span> <span class="n">MotorNormMode</span><span class="o">.</span><span class="n">RANGE_M100_100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bus</span> <span class="o">=</span> <span class="n">FeetechMotorsBus</span><span class="p">(</span>
            <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
            <span class="n">motors</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">"shoulder_pan"</span><span class="p">:</span> <span class="n">Motor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"sts3215"</span><span class="p">,</span> <span class="n">norm_mode_body</span><span class="p">),</span>
                <span class="s2">"shoulder_lift"</span><span class="p">:</span> <span class="n">Motor</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"sts3215"</span><span class="p">,</span> <span class="n">norm_mode_body</span><span class="p">),</span>
                <span class="s2">"elbow_flex"</span><span class="p">:</span> <span class="n">Motor</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">"sts3215"</span><span class="p">,</span> <span class="n">norm_mode_body</span><span class="p">),</span>
                <span class="s2">"wrist_flex"</span><span class="p">:</span> <span class="n">Motor</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">"sts3215"</span><span class="p">,</span> <span class="n">norm_mode_body</span><span class="p">),</span>
                <span class="s2">"wrist_roll"</span><span class="p">:</span> <span class="n">Motor</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">"sts3215"</span><span class="p">,</span> <span class="n">norm_mode_body</span><span class="p">),</span>
                <span class="s2">"gripper"</span><span class="p">:</span> <span class="n">Motor</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s2">"sts3215"</span><span class="p">,</span> <span class="n">MotorNormMode</span><span class="o">.</span><span class="n">RANGE_0_100</span><span class="p">),</span>
            <span class="p">},</span>
            <span class="n">calibration</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calibration</span><span class="p">,</span>
        <span class="p">)</span>
       <span class="c1">#ç±»å‹ä¸º FeetechMotorsBusï¼Œç”¨äºä¸ Feetech ç”µæœºè¿›è¡Œé€šä¿¡ï¼Œåˆå§‹åŒ–æ—¶ä¼ å…¥ç«¯å£ã€ç”µæœºä¿¡æ¯å’Œæ ¡å‡†ä¿¡æ¯ã€‚</span>
</code></pre></div>
<p>SO101Leaderç±»ç»§æ‰¿äº†Teleoperatorï¼Œsuper().<strong>init</strong>(config) è°ƒç”¨çˆ¶ç±» Teleoperator çš„æ„é€ å‡½æ•°åˆå§‹åŒ–çš„å±æ€§ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Teleoperator</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TeleoperatorConfig</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">id</span>
        <span class="c1">#è®¾å¤‡çš„id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_dir</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">calibration_dir</span>
            <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">calibration_dir</span>
            <span class="k">else</span> <span class="n">HF_LEROBOT_CALIBRATION</span> <span class="o">/</span> <span class="n">TELEOPERATORS</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="p">)</span>
        <span class="c1">#æ ¡å‡†æ–‡ä»¶çš„å­˜å‚¨ç›®å½•</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#åˆ›å»ºæ ¡å‡†ç›®å½•</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_fpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibration_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">.json"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calibration</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MotorCalibration</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># åˆå§‹åŒ–ä¸€ä¸ªå­—å…¸ï¼Œé”®ä¸ºå­—ç¬¦ä¸²ï¼Œå€¼ä¸ºMotorCalibration</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibration_fpath</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_load_calibration</span><span class="p">()</span>
        <span class="c1">#æ£€æŸ¥æ ¡å‡†æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨è°ƒç”¨åŠ è½½æ ¡å‡†ä¿¡æ¯çš„æ–¹æ³•ã€‚</span>
</code></pre></div>
<p>Teleoperatorå®šä¹‰äº†ä¸€ä¸ªé¥æ§çš„åŸºç±»ï¼Œå…¶æ„é€ å‡½æ•°ä¸­æ¥å—ä¸€ä¸ªTeleoperatorConfigç±»å‹çš„å‚æ•°configï¼Œä¸»è¦æœ‰ä»¥ä¸‹å±æ€§ã€‚</p>
<ul>
<li>self.idï¼šè®¾å¤‡çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä»ä¼ å…¥çš„é…ç½®å¯¹è±¡ config é‡Œè·å–ï¼Œç”¨äºåœ¨ç³»ç»Ÿä¸­å”¯ä¸€æ ‡è¯†è¯¥ SO101Leader è®¾å¤‡å®ä¾‹ã€‚</li>
<li>self.calibration_dirï¼šæ ¡å‡†æ–‡ä»¶çš„å­˜å‚¨ç›®å½•ã€‚è‹¥ config.calibration_dir æœ‰å€¼åˆ™ä½¿ç”¨è¯¥å€¼ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤è·¯å¾„ã€‚æ­¤ç›®å½•ç”¨äºå­˜æ”¾è®¾å¤‡çš„æ ¡å‡†æ–‡ä»¶ã€‚</li>
<li>self.calibration_fpathï¼šæ ¡å‡†æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œç”± self.calibration_dir å’Œè®¾å¤‡ id ç»„åˆè€Œæˆï¼Œæ–‡ä»¶æ ¼å¼ä¸º JSONã€‚</li>
<li>self.calibrationï¼šå­˜å‚¨ç”µæœºæ ¡å‡†ä¿¡æ¯çš„å­—å…¸ï¼Œé”®ä¸ºç”µæœºåç§°ï¼Œå€¼ä¸º MotorCalibration ç±»å‹çš„å¯¹è±¡ï¼Œç”¨äºä¿å­˜ç”µæœºçš„æ ¡å‡†å‚æ•°ã€‚</li>
</ul>
<p>è€ŒSO101Leaderç±»ä¸­è‡ªå·±å®šä¹‰çš„å®åŠ›å±æ€§æœ‰ - self.configï¼šç±»å‹ä¸º SO101LeaderConfigï¼Œå­˜å‚¨ä¼ å…¥çš„é…ç½®å¯¹è±¡ã€‚å€ŸåŠ©è¿™ä¸ªå±æ€§ï¼Œç±»çš„å…¶ä»–æ–¹æ³•å¯ä»¥è®¿é—®é…ç½®ä¿¡æ¯ï¼Œå¦‚ç«¯å£å·ã€æ˜¯å¦ä½¿ç”¨è§’åº¦å•ä½ç­‰ã€‚ - self.busï¼šç±»å‹ä¸º FeetechMotorsBusï¼Œç”¨äºå’Œ Feetech ç”µæœºè¿›è¡Œé€šä¿¡ã€‚åˆå§‹åŒ–æ—¶ä¼ å…¥ç«¯å£ã€ç”µæœºä¿¡æ¯å’Œæ ¡å‡†ä¿¡æ¯ï¼Œåç»­å¯ä»¥é€šè¿‡è¯¥å¯¹è±¡å®ç°ç”µæœºçš„è¯»å†™æ“ä½œã€æ ¡å‡†ç­‰åŠŸèƒ½ã€‚</p>
<p>æ€»ç»“ä¸‹å°±æ˜¯SO101Leader ç±»åŒ…å« 2 ä¸ªç±»å±æ€§å’Œå¤šä¸ªå®ä¾‹å±æ€§ï¼Œè¿™äº›å±æ€§ä»ä¸åŒå±‚é¢æè¿°äº† SO101 é¢†å¯¼è€…æ‰‹è‡‚è®¾å¤‡çš„ç±»å‹ã€é…ç½®ã€æ ¡å‡†ä¿¡æ¯ä»¥åŠä¸ç”µæœºçš„é€šä¿¡å¯¹è±¡ç­‰ã€‚è€ŒSO101Followerä¹Ÿæ˜¯åŒç†è¿™é‡Œå°±ä¸è¿‡å¤šé˜è¿°ã€‚</p>
<h2 id="_5">è¿æ¥è®¾å¤‡</h2>
<div class="codehilite"><pre><span></span><code>    <span class="n">teleop</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">robot</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</code></pre></div>
<p>è¿æ¥è®¾å¤‡å°±æ˜¯å„è‡ªè°ƒç”¨æ­¤å‰åˆ›å»ºå®ä¾‹çš„connectæ–¹æ³•ï¼Œå»ºç«‹ä¸ç¡¬ä»¶è®¾å¤‡çš„è¿æ¥ã€‚ä»¥teleopä¸ºä¾‹ï¼Œæœ€æ€»è°ƒç”¨åˆ°self.bus.connectå‘èµ·è¿æ¥å¹¶è¿›è¡Œé…ç½®ã€‚</p>
<div class="codehilite"><pre><span></span><code>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">calibrate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DeviceAlreadyConnectedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> already connected"</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bus</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_calibrated</span> <span class="ow">and</span> <span class="n">calibrate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> connected."</span><span class="p">)</span>
</code></pre></div>
<h2 id="_6">è·Ÿéšæ§åˆ¶</h2>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">teleop_loop</span><span class="p">(</span>
    <span class="n">teleop</span><span class="p">:</span> <span class="n">Teleoperator</span><span class="p">,</span> <span class="n">robot</span><span class="p">:</span> <span class="n">Robot</span><span class="p">,</span> <span class="n">fps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">display_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
    <span class="n">display_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">robot</span><span class="o">.</span><span class="n">action_features</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">loop_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="c1">#ä»ä¸»è‡‚è·å–åŠ¨ä½œä½ç½®æ•°æ®</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">teleop</span><span class="o">.</span><span class="n">get_action</span><span class="p">()</span>
        <span class="c1">#å¦‚æœå¯åŠ¨äº†å®æ—¶æ˜¾ç¤ºï¼Œè¿›è¡Œæ˜¾ç¤º</span>
        <span class="k">if</span> <span class="n">display_data</span><span class="p">:</span>
            <span class="n">observation</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">get_observation</span><span class="p">()</span>
            <span class="n">log_rerun_data</span><span class="p">(</span><span class="n">observation</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="c1">#å°†ä¸»è‡‚çš„åŠ¨ä½œä½ç½®æ•°æ®å‘é€ç»™ä»è‡‚</span>
        <span class="n">robot</span><span class="o">.</span><span class="n">send_action</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        <span class="c1">#è®¡ç®—å¾ªç¯æ‰§è¡Œæ—¶é—´</span>
        <span class="n">dt_s</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">loop_start</span>
        <span class="n">busy_wait</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">fps</span> <span class="o">-</span> <span class="n">dt_s</span><span class="p">)</span>
        <span class="n">loop_s</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">loop_start</span>

        <span class="c1">#æ‰“å°åŠ¨ä½œçš„ä¿¡æ¯ï¼Œæ¯ä¸ªèˆµæœºçš„ä½ç½®ã€‚</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"-"</span> <span class="o">*</span> <span class="p">(</span><span class="n">display_len</span> <span class="o">+</span> <span class="mi">10</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="s1">'NAME'</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">display_len</span><span class="si">}}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">'NORM'</span><span class="si">:</span><span class="s2">&gt;7</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">motor</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">action</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">motor</span><span class="si">:</span><span class="s2">&lt;</span><span class="si">{</span><span class="n">display_len</span><span class="si">}}</span><span class="s2"> | </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">&gt;7.2f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">time: </span><span class="si">{</span><span class="n">loop_s</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">ms (</span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">loop_s</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> Hz)"</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="n">duration</span><span class="p">:</span>
            <span class="k">return</span>
         <span class="c1"># å°†ç»ˆç«¯çš„æ–‡æœ¬å…‰æ ‡å‘ä¸Šç§»åŠ¨ä¸€å®šçš„è¡Œæ•°ï¼Œä»¥æ­¤å®ç°è¦†ç›–ä¸Šä¸€æ¬¡è¾“å‡ºå†…å®¹çš„æ•ˆæœï¼Œä»è€Œåœ¨ç»ˆç«¯é‡Œæ¨¡æ‹Ÿå®æ—¶æ›´æ–°çš„æ˜¾ç¤º</span>
        <span class="n">move_cursor_up</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>
  <div class="post-nav">
    <a class="prev" href="lerobotå½•åˆ¶.html">â† lerobotå½•åˆ¶</a>
    <a class="next" href="lerobotè®¾å¤‡æ ‡å®š.html">lerobotè®¾å¤‡æ ‡å®š â†’</a>
  </div>
</article>

      </section>

      <aside class="right-panel">
        
      </aside>
    </main>

    <footer class="site-footer">
      <div class="container">Copyright Â©2022-2025 laumy ç‰ˆæƒæ‰€æœ‰</div>
    </footer>

    <script src="assets/site.js"></script>
  </body>
  </html>


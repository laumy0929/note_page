<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>çº¿æ€§å›å½’å®ç° - Laumyçš„æŠ€æœ¯æ ˆ</title>
    <link rel="stylesheet" href="assets/style.css">
    <!-- MathJaxæ”¯æŒLaTeXæ•°å­¦å…¬å¼ -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          processEnvironments: true
        },
        options: {
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        }
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="logo" href="./">Laumyçš„æŠ€æœ¯æ ˆ</a>
        <div class="search">
          <input id="search-input" type="text" placeholder="è¾“å…¥å…³é”®è¯å›è½¦æœç´¢">
        </div>
        <div class="theme-toggle" title="åˆ‡æ¢ä¸»é¢˜" id="theme-toggle">â˜¾</div>
        <nav class="top-nav">
          <div class="nav-item"><a href="./">é¦–é¡µ</a></div>
          <div class="nav-item site-link">
            <a href="https://www.laumy.tech" target="_blank" title="è®¿é—®ä¸»ç«™">ä¸»ç«™ç‚¹:www.laumy.tech</a>
          </div>
        </nav>
      </div>
    </header>

    <main class="container layout">
      <aside class="left-nav">
        
        <div class="card">
          <div class="card-title">æ–‡ç« ç›®å½•</div>
          <nav id="toc"><ul><li><a href="#_1">çº¿æ€§å›å½’</a><ul></ul></li><li><a href="#_2">çº¿æ€§å›å½’ç¤ºä¾‹å®ç°</a><ul><li><a href="#_3">è¯»å–æ•°æ®é›†</a></li><li><a href="#_4">å®šä¹‰æ¨¡å‹</a></li><li><a href="#_5">å®šä¹‰æŸå¤±å‡½æ•°</a></li><li><a href="#_6">ä¼˜åŒ–å‚æ•°</a></li><li><a href="#_7">è®­ç»ƒ</a></li></ul></li></ul></nav>
        </div>
        
      </aside>

      <section class="content">
        
<article class="card post">
  <h1>çº¿æ€§å›å½’å®ç°</h1>
  <div class="meta">
    <span class="meta-item">
      <i class="icon">ğŸ•’</i>
      2025-04-24
    </span>
    <span class="meta-item">
      <i class="icon">ğŸ“‚</i>
      ai
    </span>
    <span class="meta-item">
      <i class="icon">ğŸ‘¤</i>
      laumy
    </span>
  </div>
  <div class="post-content"><h2 id="_1">çº¿æ€§å›å½’</h2>
<p>çº¿æ€§å›å½’æ¨¡å‹æ ¹æ®ç»™å®šçš„æ•°æ®é›†å’Œå¯¹åº”çš„æ ‡ç­¾ï¼Œé€šè¿‡ä¸€ä¸ªå‡½æ•°æ¨¡å‹æ¥æ‹Ÿåˆæ•°æ®é›†ä»¥åŠå¯¹åº”æ ‡ç­¾çš„æ˜ å°„å…³ç³»ã€‚è€Œè¿™ä¸ªæ¨¡å‹å¯ä»¥è®¾ç½®ä¸ºy=wx+bçš„ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ä¸­xå’Œwæ˜¯ä¸€ä¸ªå‘é‡ã€‚ç›®æ ‡å°±æ˜¯æ‰¾å‡ºæƒé‡wå’Œåæ‰§bçš„å€¼ï¼Œä½¿å¾—æ¨¡å‹æ›´é€¼è¿‘æ•°æ®é›†åˆçš„è§„å¾‹ï¼Œä¹Ÿå°±æ˜¯èƒ½å¤Ÿé¢„æµ‹çš„æ›´å‡†ç¡®ã€‚</p>
<h2 id="_2">çº¿æ€§å›å½’ç¤ºä¾‹å®ç°</h2>
<p>pytorchæœ¬èº«æœ‰çº¿æ€§å›å½’çš„å‡½æ•°ï¼Œåªæ˜¯è¿™é‡Œé€šè¿‡å®ç°pytochæ¥åŠ æ·±ç†è§£</p>
<h3 id="_3">è¯»å–æ•°æ®é›†</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">data_iter</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">num_examples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span> <span class="c1">#è·å–æ•°æ®çš„é•¿åº¦ï¼Œå‡1000è¡Œï¼Œè¾“å‡º1000</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_examples</span><span class="p">))</span> <span class="c1">#ç”Ÿæˆä¸€ä¸ªä¸‹æ ‡ï¼Œç»“æœ[0,...,999]</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span><span class="c1">#æ‰“æ•£indicesï¼Œä½¿æ•°æ®éšæœºï¼Œç»“æœ[77,99,0,13,....]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_examples</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span> <span class="c1">#è¡¨ç¤ºä»0åˆ°num_examplesï¼Œæ­¥é•¿ä¸º batch_size</span>
        <span class="n">batch_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
        <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_examples</span><span class="p">)])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">batch_indices</span><span class="p">)</span>
        <span class="c1">#i åˆ° i + batch_size çš„ç´¢å¼•è½¬æ¢ä¸ºä¸€ PyTorchå¼ é‡</span>
        <span class="k">yield</span> <span class="n">features</span><span class="p">[</span><span class="n">batch_indices</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="n">batch_indices</span><span class="p">]</span>
        <span class="c1">#æ¯æ¬¡å¾ªç¯æ—¶ï¼Œyield ä¼šè¿”å›ä¸€ä¸ªå…ƒç»„ (features_batch, labels_batch)ï¼Œ</span>
        <span class="c1">#å…¶ä¸­ features_batch æ˜¯ä¸€ä¸ªåŒ…å«è¯¥æ‰¹æ¬¡ç‰¹å¾æ•°æ®çš„ Tensorï¼Œlabels_batch</span>
        <span class="c1">#æ˜¯è¯¥æ‰¹æ¬¡å¯¹åº”çš„æ ‡ç­¾æ•°æ®ã€‚</span>
</code></pre></div>
<p>å®šä¹‰ä¸€ä¸ªå‡½æ•°data_iterï¼Œå°†æ•°æ®é›†ï¼ˆxï¼‰ã€ä»¥åŠæ•°æ®é›†å¯¹åº”çš„ç‰¹å¾ï¼ˆyï¼‰ä½œä¸ºå‡½æ•°è¾“å…¥ï¼Œåˆ†å‰²æˆå¤§å°ä¸ºbatch_sizeçš„å°æ‰¹é‡æ•°æ®é›†ï¼ˆxï¼‰å’Œç‰¹å¾é›†ï¼ˆyï¼‰ã€‚ä¹‹æ‰€ä»¥è¦è¿›è¡Œåˆ†å‰²æ¯æ¬¡æŠ½å–å°æ‰¹é‡æ ·æœ¬ï¼Œæ˜¯åˆ©ç”¨äº†GPUå¹¶è¡Œè¿ç®—çš„ä¼˜åŠ¿ã€‚æ¯ä¸ªæ ·æœ¬éƒ½å¯ä»¥å¹¶è¡Œåœ°è¿›è¡Œæ¨¡å‹è®¡ç®—ï¼ŒåŒæ—¶åœ¨åç»­è®¡ç®—æ¢¯åº¦æ—¶ï¼Œæ¯ä¸ªæ ·æœ¬æŸå¤±å‡½æ•°çš„æ¢¯åº¦å¯ä»¥è¢«å¹¶è¡Œè®¡ç®—ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">for</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">data_iter</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">break</span>

<span class="n">è¿è¡Œç»“æœ</span>

<span class="n">tensor</span><span class="p">([</span><span class="mi">940</span><span class="p">,</span>  <span class="mi">41</span><span class="p">,</span> <span class="mi">385</span><span class="p">,</span> <span class="mi">262</span><span class="p">,</span> <span class="mi">655</span><span class="p">,</span> <span class="mi">402</span><span class="p">,</span> <span class="mi">317</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">984</span><span class="p">,</span> <span class="mi">644</span><span class="p">])</span> <span class="o">--</span><span class="nb">print</span><span class="p">(</span><span class="n">batch_indices</span><span class="p">)</span>

<span class="n">tensor</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.9666</span><span class="p">,</span>  <span class="mf">0.8299</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">1.8890</span><span class="p">,</span>  <span class="mf">0.1645</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.0274</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6944</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">2.0289</span><span class="p">,</span>  <span class="mf">0.7227</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.0077</span><span class="p">,</span>  <span class="mf">0.6674</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.8692</span><span class="p">,</span>  <span class="mf">0.5002</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.9469</span><span class="p">,</span>  <span class="mf">1.7404</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.8589</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5467</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.1260</span><span class="p">,</span>  <span class="mf">0.1262</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.6988</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0683</span><span class="p">]])</span> 
 <span class="n">tensor</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.5347</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.1296</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">6.6105</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">5.7961</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">3.9675</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">6.2448</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">3.5983</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">7.7625</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">6.0183</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">3.0294</span><span class="p">]])</span>
</code></pre></div>
<p>é‚£ä¹ˆè®­ç»ƒçš„æ•°æ®é›†å’Œç‰¹å¾æ€ä¹ˆæ¥äº†ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡éœ€è¦è®­ç»ƒçš„ç›®æ ‡å¤„ç†å¾—æ¥ï¼Œä¸ºäº†æ–¹ä¾¿æœ¬ç« ç”¨ä¸€ä¸ªå‡½æ•°æ¥æ¨¡æ‹Ÿç”Ÿæˆæ•°æ®é›†ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">synthetic_data</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">num_examples</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">num_examples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>
<p>ä¸Šé¢è¿™ä¸ªå‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯ç»™å…ˆæŒ‡äº†wå’Œbç”Ÿæˆy=wx+bæ¨¡å‹ä¸­çš„xå’Œy, è€Œæˆ‘ä»¬å°±æ˜¯è¦è®­ç»ƒæ‰¾å‡ºwå’Œbã€‚</p>
<ul>
<li>
<p>ç”Ÿæˆè¾“å…¥æ•°æ® Xï¼štorch.normal(mean, std, size) ç”¨äºä»æ­£æ€åˆ†å¸ƒä¸­ç”Ÿæˆæ•°æ®ã€‚è¿™é‡Œï¼Œmean=0 è¡¨ç¤ºå‡å€¼ä¸º0ï¼Œstd=1 è¡¨ç¤ºæ ‡å‡†å·®ä¸º1ã€‚(num_examples, len(w)) æ˜¯ç”Ÿæˆå¼ é‡çš„å½¢çŠ¶ï¼Œè¿™é‡Œ num_examples æ˜¯ç”Ÿæˆçš„æ ·æœ¬æ•°ï¼Œlen(w) æ˜¯æ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾æ•°ï¼ˆå³æƒé‡å‘é‡ w çš„é•¿åº¦ï¼‰ã€‚æ‰€ä»¥ X æ˜¯ä¸€ä¸ªå½¢çŠ¶ä¸º (num_examples, len(w)) çš„çŸ©é˜µï¼Œå…¶ä¸­åŒ…å«äº†ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒä¸­é‡‡æ ·çš„ç‰¹å¾æ•°æ®ã€‚</p>
</li>
<li>
<p>ç”Ÿæˆæ ‡ç­¾ y: torch.matmul(X, w) è®¡ç®—è¾“å…¥ç‰¹å¾ X å’Œæƒé‡ w çš„çŸ©é˜µä¹˜æ³•ã€‚ç»“æœæ˜¯ä¸€ä¸ªå½¢çŠ¶ä¸º (num_examples,) çš„å¼ é‡ï¼Œè¡¨ç¤ºæ¯ä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼ï¼ˆä¸åŒ…æ‹¬åç½®ï¼‰ã€‚+ b å°†åç½® b åŠ åˆ°æ¯ä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼ä¸­ï¼Œè¿™æ ·å°±å¾—åˆ°æœ€ç»ˆçš„æ ‡ç­¾ yã€‚è¿™å°±æ˜¯çº¿æ€§å›å½’æ¨¡å‹ä¸­çš„å…¬å¼ y = Xw + bã€‚</p>
</li>
<li>
<p>æ·»åŠ å™ªå£°ï¼š torch.normal(0, 0.01, y.shape) ç”Ÿæˆä¸€ä¸ªä¸ y å½¢çŠ¶ç›¸åŒçš„å™ªå£°é¡¹ï¼Œå™ªå£°æ¥è‡ªå‡å€¼ä¸º 0ï¼Œæ ‡å‡†å·®ä¸º 0.01 çš„æ­£æ€åˆ†å¸ƒã€‚è¿™ä¸€æ­¥æ˜¯ä¸ºäº†ç»™æ•°æ®æ·»åŠ ä¸€äº›éšæœºå™ªå£°ï¼Œä½¿å¾—ç”Ÿæˆçš„æ•°æ®æ›´ç¬¦åˆå®é™…æƒ…å†µã€‚ç°å®ä¸­ï¼Œæ•°æ®é€šå¸¸ä¼šæœ‰ä¸€äº›è¯¯å·®æˆ–å™ªå£°ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ ‡ç­¾ y ä¸Šæ·»åŠ å°çš„éšæœºæ³¢åŠ¨ã€‚</p>
</li>
<li>
<p>è¿”å›æ•°æ®: X æ˜¯ç”Ÿæˆçš„è¾“å…¥ç‰¹å¾æ•°æ®ã€‚y.reshape((-1, 1)) å°†æ ‡ç­¾ y è½¬æ¢ä¸ºä¸€ä¸ªå½¢çŠ¶ä¸º (num_examples, 1) çš„åˆ—å‘é‡ï¼Œä»¥ç¡®ä¿æ ‡ç­¾çš„å½¢çŠ¶æ˜¯åˆ—å‘é‡ã€‚</p>
</li>
</ul>
<p>ç”Ÿæˆåˆæˆçš„çº¿æ€§æ•°æ®é›†ï¼Œæ•°æ®é›†çš„ç‰¹å¾ X æ˜¯ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒä¸­é‡‡æ ·çš„ï¼Œè€Œæ ‡ç­¾ y æ˜¯é€šè¿‡çº¿æ€§æ–¹ç¨‹ y = Xw + b ç”Ÿæˆçš„ï¼Œå¹¶ä¸”åœ¨ y ä¸Šæ·»åŠ äº†ä¸€äº›å°çš„å™ªå£°ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="n">true_w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4</span><span class="p">])</span>
<span class="n">true_b</span> <span class="o">=</span> <span class="mf">4.2</span>
<span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">synthetic_data</span><span class="p">(</span><span class="n">true_w</span><span class="p">,</span> <span class="n">true_b</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'features:'</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">features len'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">),</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">label:'</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="n">è¿è¡Œç»“æœ</span>
<span class="n">features</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([[</span> <span class="mf">4.3255e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4288e+00</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">2.2412e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8749e-01</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">5.6843e-01</span><span class="p">,</span>  <span class="mf">1.0930e+00</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.3660e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8141e-03</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">3.9331e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4553e-02</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">6.3184e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.4748e-01</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">1.7891e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4018e+00</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">4.8070e-01</span><span class="p">,</span>  <span class="mf">8.5689e-01</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">2.0670e+00</span><span class="p">,</span>  <span class="mf">3.8301e-02</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">1.7682e+00</span><span class="p">,</span>  <span class="mf">1.9595e-01</span><span class="p">]])</span> 
<span class="n">features</span> <span class="nb">len</span> <span class="mi">10</span> 
<span class="n">label</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([[</span> <span class="mf">9.9307</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">5.2856</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">0.6669</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">6.9439</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">5.0759</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">5.8344</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">8.9642</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.3175</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">8.2140</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">7.0458</span><span class="p">]])</span>
</code></pre></div>
<h3 id="_4">å®šä¹‰æ¨¡å‹</h3>
<p>æˆ‘ä»¬çš„æ¨¡å‹å‡½æ•°æ˜¯y=wX+bï¼Œä¹Ÿå°±æ˜¯è®¡ç®—è¾“å…¥ç‰¹å¾Xå’Œæƒé‡Wï¼Œè¿™é‡Œçš„Xwæ˜¯ä¸€ä¸ªå‘é‡ï¼Œè€Œbæ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œä½†æ˜¯ç”¨ä¸€ä¸ªå‘é‡åŠ ä¸Šä¸€ä¸ªæ ‡é‡æ˜¯ï¼Œæ ‡é‡ä¼šè¢«åŠ åˆ°æ¯ä¸ªåˆ†é‡ä¸Šï¼Œè¿™æ˜¯å¹¿æ’­æœºåˆ¶ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">linreg</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
</code></pre></div>
<p>åœ¨å¼€å§‹è®¡ç®—éšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–æ¨¡å‹å‚æ•°ä¹‹å‰ï¼Œéœ€è¦å…ˆé¢„è®¾ä¸€äº›å‚æ•°ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨æ­£æ€åˆ†å¸ƒéšæœºåˆå§‹åŒ–wå’Œbã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">b</span>
</code></pre></div>
<h3 id="_5">å®šä¹‰æŸå¤±å‡½æ•°</h3>
<p>æŸå¤±å‡½æ•°å°±æ˜¯æ ¹æ®æˆ‘ä»¬é‡‡æ ·å¤„ç†çš„æ•°æ®Xè¾“å…¥åˆ°æˆ‘ä»¬çš„æ¨¡å‹ä¸­è®¡ç®—å¤„ç†çš„å€¼yâ€™è·ŸçœŸå®å€¼yçš„å·®è·ï¼Œè¿™é‡Œä½¿ç”¨å¹³æ–¹æŸå¤±å‡½æ•°,å³loss=(yâ€™-y)^2ï¼Œè¯¦ç»†çš„å…¬å¼ä¸ºï¼š$ L(w, b) = \frac{1}{n} \sum_{i=1}^{n} \ell^{(i)}(w, b) = \frac{1}{n} \sum_{i=1}^{n} \left( \frac{1}{2} \left( w^\top x^{(i)} + b - y^{(i)} \right)^2 \right) $</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">squared_loss</span><span class="p">(</span><span class="n">y_hat</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">y_hat</span> <span class="o">-</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_hat</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>
</code></pre></div>
<h3 id="_6">ä¼˜åŒ–å‚æ•°</h3>
<p>è¯¦ç»†çš„å…¬å¼ä¸ºï¼š$ (w, b) \leftarrow (w, b) - \frac{\eta}{|B|} \sum_{i \in B} \nabla_{(w, b)} \ell^{(i)}(w, b) $</p>
<p>æŸå¤±å‡½æ•°æ˜¯å¯¹å¯¹åº”å‚æ•°æ±‚çš„åå¯¼ï¼Œå³å¦‚æœæ˜¯$w$å°±æ˜¯å¯¹$w$çš„åå¯¼ï¼Œå¦‚æœæ˜¯$b$å°±æ˜¯$b$çš„åå¯¼ï¼Œ$x$æ˜¯å½“å‰é‡‡æ ·çš„å…·ä½“å€¼ï¼ˆä¸æ˜¯å˜é‡ï¼‰ï¼Œå…¬å¼ä¸­çš„$B$æ˜¯æŠ½æ ·çš„å°æ‰¹é‡ï¼Œæ˜¯å›ºå®šæ•°é‡çš„è®­ç»ƒæ ·æœ¬ã€‚</p>
<p>å…·ä½“ç®—æ³•çš„æ­¥éª¤å¦‚ä¸‹ï¼Œå¯¹äº$W$æ›´æ–°å‚æ•°çš„å…¬å¼ä¸ºï¼š</p>
<p>$ w \leftarrow w - \frac{\eta}{|B|} \sum_{i \in B} \frac{\partial \ell^{(i)}}{\partial w}(w, b) = w - \frac{\eta}{|B|} \sum_{i \in B} x^{(i)} \left( w^\top x^{(i)} + b - y^{(i)} \right) $</p>
<p>å¯¹äº$b$æ›´æ–°å‚æ•°çš„å…¬å¼ä¸ºï¼š $ b \leftarrow b - \frac{\eta}{|B|} \sum_{i \in B} \frac{\partial \ell^{(i)}}{\partial b}(w, b) = b - \frac{\eta}{|B|} \sum_{i \in B} \left( w^\top x^{(i)} + b - y^{(i)} \right) $</p>
<p>ä»ä¸Šé¢çš„å…¬å¼å¯ä»¥çœ‹å‡ºï¼Œæ¢¯åº¦æ˜¯æ‰¹é‡è¯¯å·®çš„å’Œï¼Œæ²¡å¤„ç†ä¸€ä¸ªæ‰¹é‡æ•°æ®ï¼Œæ›´æ–°ä¸€æ¬¡å‚æ•°ï¼Œè€Œä¸æ˜¯æ¯å¤„ç†ä¸€ä¸ªæ•°æ®æ›´æ–°ä¸€æ¬¡å‚æ•°ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">sgd</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="n">param</span> <span class="o">-=</span> <span class="n">lr</span> <span class="o">*</span> <span class="n">param</span><span class="o">.</span><span class="n">grad</span> <span class="o">/</span> <span class="n">batch_size</span> <span class="c1">#æ¢¯åº¦å€¼ä¸ºparam.grad</span>
            <span class="n">param</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
</code></pre></div>
<p>param.gradæ˜¯å“ªé‡Œæ¥çš„ï¼Ÿ ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—è€Œæ¥ï¼Œä¸‹ä¸€ç« èŠ‚ä¼šä»‹ç»ã€‚</p>
<h3 id="_7">è®­ç»ƒ</h3>
<p>åœ¨è®­ç»ƒä¹‹å‰ï¼Œéœ€è¦å…ˆåˆå§‹åŒ–å‚æ•°ï¼Œ</p>
<div class="codehilite"><pre><span></span><code><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">b</span>
</code></pre></div>
<p>æ¥ä¸‹æ¥å¼€å§‹è®­ç»ƒ</p>
<div class="codehilite"><pre><span></span><code><span class="n">lr</span> <span class="o">=</span> <span class="mf">0.03</span>
<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">linreg</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">squared_loss</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">data_iter</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Xå’Œyçš„å°æ‰¹é‡æŸå¤±</span>
        <span class="c1"># å› ä¸ºlå½¢çŠ¶æ˜¯(batch_size,1)ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ ‡é‡ã€‚lä¸­çš„æ‰€æœ‰å…ƒç´ è¢«åŠ åˆ°ä¸€èµ·ï¼Œ</span>
        <span class="c1"># å¹¶ä»¥æ­¤è®¡ç®—å…³äº[w,b]çš„æ¢¯åº¦</span>
        <span class="n">l</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">sgd</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span> <span class="n">lr</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>  <span class="c1"># ä½¿ç”¨å‚æ•°çš„æ¢¯åº¦æ›´æ–°å‚æ•°</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'true_w'</span><span class="p">,</span><span class="n">true_w</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">true_b'</span><span class="p">,</span> <span class="n">true_b</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">train_l</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">net</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">labels</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'epoch </span><span class="si">{</span><span class="n">epoch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">, loss </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">train_l</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="si">:</span><span class="s1">f</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'wçš„ä¼°è®¡è¯¯å·®: </span><span class="si">{</span><span class="n">true_w</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">w</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">true_w</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'bçš„ä¼°è®¡è¯¯å·®: </span><span class="si">{</span><span class="n">true_b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</code></pre></div>
<p>ä¸ºä»€ä¹ˆl.sum().backwardèƒ½å¤Ÿè‡ªåŠ¨è®¡ç®—å­˜å‚¨æ¢¯åº¦å€¼ï¼Ÿ åœ¨åˆå§‹åŒ–wå’Œbçš„å‚æ•°æ—¶ï¼Œè®¾å®šäº†requires_grad=Trueã€‚åœ¨è®¡ç®—æŸå¤±æ—¶ï¼Œnet(X, w, b)ä¼šç”Ÿæˆé¢„æµ‹å€¼y_hatï¼Œå¹¶é€šè¿‡losså‡½æ•°ä¸çœŸå®å€¼yæ„å»ºè®¡ç®—å›¾ã€‚è°ƒç”¨l.sum().backward()æ—¶ï¼ŒPyTorchçš„autogradç³»ç»Ÿä¼šä»æ ‡é‡æŸå¤±l.sum()å¼€åå‘ä¼ æ’­ï¼Œè‡ªåŠ¨è®¡ç®—wå’Œbçš„æ¢¯åº¦ï¼Œå¹¶å­˜å‚¨åœ¨w.gradå’Œb.gradä¸­ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="n">tensor</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="o">---</span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">true_w</span> <span class="n">tensor</span><span class="p">([</span> <span class="mf">2.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4000</span><span class="p">])</span> <span class="n">w</span> <span class="n">tensor</span><span class="p">([[</span> <span class="mf">2.0056</span><span class="p">],[</span><span class="o">-</span><span class="mf">3.4014</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">true_b</span> <span class="mf">4.2</span> <span class="n">b</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">4.1983</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">epoch</span> <span class="mi">1</span><span class="p">,</span> <span class="n">loss</span> <span class="mf">0.000056</span>

<span class="n">tensor</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">true_w</span> <span class="n">tensor</span><span class="p">([</span> <span class="mf">2.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4000</span><span class="p">])</span> <span class="n">w</span> <span class="n">tensor</span><span class="p">([[</span> <span class="mf">2.0056</span><span class="p">],[</span><span class="o">-</span><span class="mf">3.4014</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">true_b</span> <span class="mf">4.2</span> <span class="n">b</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">4.1983</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">epoch</span> <span class="mi">2</span><span class="p">,</span> <span class="n">loss</span> <span class="mf">0.000056</span>

<span class="n">tensor</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">true_w</span> <span class="n">tensor</span><span class="p">([</span> <span class="mf">2.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4000</span><span class="p">])</span> <span class="n">w</span> <span class="n">tensor</span><span class="p">([[</span> <span class="mf">2.0056</span><span class="p">],[</span><span class="o">-</span><span class="mf">3.4014</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">true_b</span> <span class="mf">4.2</span> <span class="n">b</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">4.1983</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">epoch</span> <span class="mi">3</span><span class="p">,</span> <span class="n">loss</span> <span class="mf">0.000056</span>

<span class="n">tensor</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">true_w</span> <span class="n">tensor</span><span class="p">([</span> <span class="mf">2.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4000</span><span class="p">])</span> <span class="n">w</span> <span class="n">tensor</span><span class="p">([[</span> <span class="mf">2.0056</span><span class="p">],[</span><span class="o">-</span><span class="mf">3.4014</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">true_b</span> <span class="mf">4.2</span> <span class="n">b</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">4.1983</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">epoch</span> <span class="mi">4</span><span class="p">,</span> <span class="n">loss</span> <span class="mf">0.000056</span>

<span class="n">tensor</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">true_w</span> <span class="n">tensor</span><span class="p">([</span> <span class="mf">2.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4000</span><span class="p">])</span> <span class="n">w</span> <span class="n">tensor</span><span class="p">([[</span> <span class="mf">2.0056</span><span class="p">],[</span><span class="o">-</span><span class="mf">3.4014</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">true_b</span> <span class="mf">4.2</span> <span class="n">b</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">4.1983</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">epoch</span> <span class="mi">5</span><span class="p">,</span> <span class="n">loss</span> <span class="mf">0.000056</span>

<span class="n">tensor</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">true_w</span> <span class="n">tensor</span><span class="p">([</span> <span class="mf">2.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4000</span><span class="p">])</span> <span class="n">w</span> <span class="n">tensor</span><span class="p">([[</span> <span class="mf">2.0056</span><span class="p">],[</span><span class="o">-</span><span class="mf">3.4014</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">true_b</span> <span class="mf">4.2</span> <span class="n">b</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">4.1983</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">epoch</span> <span class="mi">6</span><span class="p">,</span> <span class="n">loss</span> <span class="mf">0.000056</span>

<span class="n">tensor</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">true_w</span> <span class="n">tensor</span><span class="p">([</span> <span class="mf">2.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.4000</span><span class="p">])</span> <span class="n">w</span> <span class="n">tensor</span><span class="p">([[</span> <span class="mf">2.0056</span><span class="p">],[</span><span class="o">-</span><span class="mf">3.4014</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">true_b</span> <span class="mf">4.2</span> <span class="n">b</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">4.1983</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p>è¯¯å·®ç»“æœï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="n">wçš„ä¼°è®¡è¯¯å·®</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mf">0.0056</span><span class="p">,</span>  <span class="mf">0.0014</span><span class="p">],</span> <span class="n">grad_fn</span><span class="o">=&lt;</span><span class="n">SubBackward0</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">bçš„ä¼°è®¡è¯¯å·®</span><span class="p">:</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">0.0017</span><span class="p">],</span> <span class="n">grad_fn</span><span class="o">=&lt;</span><span class="n">RsubBackward1</span><span class="o">&gt;</span><span class="p">)</span>
</code></pre></div>
<p>æœ¬æ–‡æ¥è‡ªï¼š <a href="https://zh.d2l.ai/" title="&lt;åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹  V2&gt;">&lt;åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹  V2&gt;</a> çš„å­¦ä¹ ç¬”è®°</p></div>
  <div class="post-nav">
    <a class="prev" href="sotfmaxå›å½’å®ç°.html">â† sotfmaxå›å½’å®ç°</a>
    <a class="next" href="å°æ™ºaiè¯­éŸ³äº¤äº’ç®€è¦åˆ†æ.html">å°æ™ºAiè¯­éŸ³äº¤äº’ç®€è¦åˆ†æ â†’</a>
  </div>
</article>

      </section>

      <aside class="right-panel">
        
      </aside>
    </main>

    <footer class="site-footer">
      <div class="container">Copyright Â©2022-2025 laumy ç‰ˆæƒæ‰€æœ‰</div>
    </footer>

    <script src="assets/site.js"></script>
  </body>
  </html>


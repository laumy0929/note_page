<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>æ¢¯åº¦è®¡ç®— - Laumyçš„æŠ€æœ¯æ ˆ</title>
    <link rel="stylesheet" href="assets/style.css">
    <!-- MathJaxæ”¯æŒLaTeXæ•°å­¦å…¬å¼ -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          processEnvironments: true
        },
        options: {
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        }
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="logo" href="./">Laumyçš„æŠ€æœ¯æ ˆ</a>
        <div class="search">
          <input id="search-input" type="text" placeholder="è¾“å…¥å…³é”®è¯å›è½¦æœç´¢">
        </div>
        <div class="theme-toggle" title="åˆ‡æ¢ä¸»é¢˜" id="theme-toggle">â˜¾</div>
        <nav class="top-nav">
          <div class="nav-item"><a href="./">é¦–é¡µ</a></div>
          <div class="nav-item site-link">
            <a href="https://www.laumy.tech" target="_blank" title="è®¿é—®ä¸»ç«™">ä¸»ç«™ç‚¹:www.laumy.tech</a>
          </div>
        </nav>
      </div>
    </header>

    <main class="container layout">
      <aside class="left-nav">
        
        <div class="card">
          <div class="card-title">æ–‡ç« ç›®å½•</div>
          <nav id="toc"><ul><li><a href="#_1">ä»€ä¹ˆæ˜¯æ¢¯åº¦</a><ul><li><a href="#_2">ç›´è§‚ç†è§£æ¢¯åº¦</a></li><li><a href="#_3">æ¢¯åº¦åœ¨æœºå™¨å­¦ä¹ ä¸­çš„ä½œç”¨</a></li></ul></li><li><a href="#_4">æ¢¯åº¦ä¸‹é™çš„ç¤ºä¾‹</a><ul></ul></li><li><a href="#_5">æ¢¯åº¦è®¡ç®—æ¨å¯¼</a><ul><li><a href="#1">æ­¥éª¤ 1: å®šä¹‰æŸå¤±å‡½æ•°</a></li><li><a href="#2">æ­¥éª¤ 2: ä½¿ç”¨é“¾å¼æ³•åˆ™æ±‚æ¢¯åº¦</a></li><li><a href="#3">æ­¥éª¤ 3: è®¡ç®—æ¯ä¸€éƒ¨åˆ†çš„åå¯¼æ•°</a></li><li><a href="#4">æ­¥éª¤ 4: åˆå¹¶ç»“æœ</a></li><li><a href="#5">æ­¥éª¤ 5: å°†å…·ä½“æ•°å€¼ä»£å…¥</a></li></ul></li><li><a href="#pytorch">pytorchç¤ºä¾‹</a><ul></ul></li></ul></nav>
        </div>
        
      </aside>

      <section class="content">
        
<article class="card post">
  <h1>æ¢¯åº¦è®¡ç®—</h1>
  <div class="meta">
    <span class="meta-item">
      <i class="icon">ğŸ•’</i>
      2025-05-01
    </span>
    <span class="meta-item">
      <i class="icon">ğŸ“‚</i>
      ai
    </span>
    <span class="meta-item">
      <i class="icon">ğŸ‘¤</i>
      laumy
    </span>
  </div>
  <div class="post-content"><h2 id="_1">ä»€ä¹ˆæ˜¯æ¢¯åº¦</h2>
<p>æ¢¯åº¦(Gradient)æ˜¯ç”¨äºæè¿°å¤šå…ƒå‡½æ•°åœ¨æŸä¸€ç‚¹çš„å˜åŒ–ç‡æœ€å¤§çš„æ–¹å‘åŠå…¶å¤§å°ã€‚åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæ¢¯åº¦è¢«å¹¿æ³›ç”¨äºä¼˜åŒ–æ¨¡å‹å‚æ•°(å¦‚ç¥ç»ç½‘ç»œçš„æƒé‡å’Œåç½®)ï¼Œé€šè¿‡æ¢¯åº¦ä¸‹é™ç­‰ç®—æ³•æœ€å°åŒ–æŸå¤±å‡½æ•°ã€‚</p>
<p>å¯¹äºå¤šå…ƒå‡½æ•° $f(x_1, x_2, \dots, x_n)$ï¼Œå…¶æ¢¯åº¦æ˜¯ä¸€ä¸ª<strong>å‘é‡</strong>ï¼Œç”±å‡½æ•°å¯¹æ¯ä¸ªå˜é‡çš„åå¯¼æ•°ç»„æˆï¼Œè®°ä½œï¼š</p>
<p>$$ \nabla f = \left( \frac{\partial f}{\partial x_1}, \frac{\partial f}{\partial x_2}, \dots, \frac{\partial f}{\partial x_n} \right) $$</p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>$\nabla f$ æ˜¯æ¢¯åº¦ç¬¦å·ï¼ˆè¯»ä½œâ€œnabla fâ€ï¼‰ã€‚</li>
<li>$\frac{\partial f}{\partial x_i}$ æ˜¯å‡½æ•° $f$ å¯¹å˜é‡ $x_i$ çš„åå¯¼æ•°ã€‚</li>
</ul>
<h3 id="_2">ç›´è§‚ç†è§£æ¢¯åº¦</h3>
<p>å‡è®¾æœ‰ä¸€ä¸ªäºŒå…ƒå‡½æ•° $f(x, y) = x^2 + y^2$ï¼Œå…¶æ¢¯åº¦ä¸ºï¼š</p>
<p>$$ \nabla f = \left( \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y} \right) = (2x, 2y) $$</p>
<p>åœ¨ç‚¹ $(1, 1)$ å¤„ï¼Œæ¢¯åº¦ä¸º $(2, 2)$ï¼Œè¡¨ç¤ºå‡½æ•°åœ¨è¯¥ç‚¹æ²¿æ–¹å‘ $(2, 2)$ å¢é•¿æœ€å¿«ã€‚</p>
<p>è‹¥æƒ³æœ€å°åŒ– $f(x, y)$ï¼Œåº”æ²¿ç€è´Ÿæ¢¯åº¦æ–¹å‘ $-(2, 2)$ ç§»åŠ¨ï¼Œå³æ›´æ–°å‚æ•°ï¼š</p>
<p>$$ x \leftarrow x - \alpha \cdot 2x $$</p>
<p>$$ y \leftarrow y - \alpha \cdot 2y $$</p>
<p>å…¶ä¸­ $\alpha$ æ˜¯å­¦ä¹ ç‡ã€‚</p>
<h3 id="_3">æ¢¯åº¦åœ¨æœºå™¨å­¦ä¹ ä¸­çš„ä½œç”¨</h3>
<p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ¢¯åº¦è¡¨ç¤ºæŸå¤±å‡½æ•°ï¼ˆLoss Functionï¼‰å¯¹æ¨¡å‹å‚æ•°çš„æ•æ„Ÿåº¦ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæ¨¡å‹å‚æ•° $W$ï¼ˆæƒé‡ï¼‰å’Œ $b$ï¼ˆåç½®ï¼‰ï¼Œæ¢¯åº¦ $\nabla L$ åŒ…å«ä¸¤ä¸ªåˆ†é‡ï¼š</p>
<p>$$ \nabla L = \left( \frac{\partial L}{\partial W}, \frac{\partial L}{\partial b} \right) $$</p>
<p>é€šè¿‡æ²¿ç€è´Ÿæ¢¯åº¦æ–¹å‘æ›´æ–°å‚æ•°ï¼ˆå³æ¢¯åº¦ä¸‹é™ï¼‰ï¼Œå¯ä»¥é€æ­¥é™ä½æŸå¤±å‡½æ•°çš„å€¼ã€‚</p>
<h2 id="_4">æ¢¯åº¦ä¸‹é™çš„ç¤ºä¾‹</h2>
<p>ç›®æ ‡ï¼šæœ€å°åŒ–å‡½æ•° ï¼ˆçº¿æ€§å›å½’çš„æŸå¤±å‡½æ•°ï¼‰ã€‚</p>
<p>$$ L(W, b) = (W \cdot x + b - y_{\text{true}})^2 $$</p>
<p>å‡è®¾</p>
<p>$$ x = 2, \quad y_{\text{true}} = 4, \quad W = 1, \quad b = 0.5 $$</p>
<p>è®¡ç®—é¢„æµ‹å€¼ï¼š</p>
<p>$$ y_{\text{pred}} = W \cdot x + b = 1 \cdot 2 + 0.5 = 2.5 $$</p>
<p>è®¡ç®—æŸå¤±ï¼š</p>
<p>$$ L = (y_{\text{pred}} - y_{\text{true}})^2 = (2.5 - 4)^2 = 2.25 $$</p>
<p>è®¡ç®—æ¢¯åº¦ï¼š</p>
<p>$$ \frac{\partial L}{\partial W} = 2 (y_{\text{pred}} - y_{\text{true}}) \cdot x = 2 (2.5 - 4) \cdot 2 = -6.0 $$</p>
<p>$$ \frac{\partial L}{\partial b} = 2 (y_{\text{pred}} - y_{\text{true}}) = 2 (2.5 - 4) = -3.0 $$</p>
<p>æ¢¯åº¦ä¸º</p>
<p>$$ \nabla L = (-6.0, -3.0) $$</p>
<p>å‚æ•°æ›´æ–°ï¼ˆå­¦ä¹ ç‡ $ (\alpha = 0.1)ï¼‰$ï¼š</p>
<p>$$ W_{\text{new}} = W - \alpha \cdot \frac{\partial L}{\partial W} = 1 - 0.1 \cdot (-6.0) = 1.6 $$</p>
<p>$$ b_{\text{new}} = b - \alpha \cdot \frac{\partial L}{\partial b} = 0.5 - 0.1 \cdot (-3.0) = 0.8 $$</p>
<h2 id="_5">æ¢¯åº¦è®¡ç®—æ¨å¯¼</h2>
<p>è¿™ä¸ªå…¬å¼æ˜¯æ¢¯åº¦è®¡ç®—ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œè®¡ç®—çš„æ˜¯æŸå¤±å‡½æ•° (L) å¯¹å‚æ•° (W) çš„åå¯¼æ•°ã€‚æˆ‘ä»¬æ¥ä¸€æ­¥æ­¥æ¨å¯¼è¿™ä¸ªå…¬å¼ã€‚</p>
<p>å‡è®¾æŸå¤±å‡½æ•°ä¸ºï¼š</p>
<p>$$ L(W, b) = (W \cdot x + b - y_{\text{true}})^2 $$</p>
<p>å…¶ä¸­$ W$æ˜¯æƒé‡ï¼Œ$b $æ˜¯åç½®ï¼Œ$x $æ˜¯è¾“å…¥ï¼Œ$y_{\text{true}} $æ˜¯çœŸå®çš„æ ‡ç­¾ã€‚æˆ‘ä»¬è¦è®¡ç®—çš„æ˜¯æŸå¤±å‡½æ•° $L$ å¯¹æƒé‡ $W$çš„åå¯¼æ•°$ \frac{\partial L}{\partial W}$ã€‚</p>
<h3 id="1">æ­¥éª¤ 1: å®šä¹‰æŸå¤±å‡½æ•°</h3>
<p>æŸå¤±å‡½æ•°æ˜¯é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„è¯¯å·®çš„å¹³æ–¹ï¼Œå®šä¹‰ä¸ºï¼š</p>
<p>$$ L(W, b) = (y_{\text{pred}} - y_{\text{true}})^2 $$</p>
<p>å…¶ä¸­ï¼Œ$y_{\text{pred}} = W \cdot x + b $æ˜¯æ¨¡å‹çš„é¢„æµ‹å€¼ã€‚è¿™ä¸ªæŸå¤±å‡½æ•°æ˜¯ä¸€ä¸ªäºŒæ¬¡å‡½æ•°ï¼Œç›®æ ‡æ˜¯æœ€å°åŒ–å®ƒã€‚</p>
<h3 id="2">æ­¥éª¤ 2: ä½¿ç”¨é“¾å¼æ³•åˆ™æ±‚æ¢¯åº¦</h3>
<p>æˆ‘ä»¬éœ€è¦å¯¹æŸå¤±å‡½æ•° (L) å…³äº (W) æ±‚åå¯¼æ•°ã€‚é¦–å…ˆå¯ä»¥åº”ç”¨é“¾å¼æ³•åˆ™ï¼š</p>
<p>$$ \frac{\partial L}{\partial W} = \frac{\partial L}{\partial y_{\text{pred}}} \cdot \frac{\partial y_{\text{pred}}}{\partial W} $$</p>
<h3 id="3">æ­¥éª¤ 3: è®¡ç®—æ¯ä¸€éƒ¨åˆ†çš„åå¯¼æ•°</h3>
<ol>
<li><strong>ç¬¬ä¸€éƒ¨åˆ†</strong>: è®¡ç®— $\frac{\partial L}{\partial y_{\text{pred}}}$ã€‚</li>
</ol>
<p>ç”±äºæŸå¤±å‡½æ•°æ˜¯å¹³æ–¹è¯¯å·®å½¢å¼ï¼š</p>
<p>$$ L = (y_{\text{pred}} - y_{\text{true}})^2 $$</p>
<p>å¯¹$y_{\text{pred}}$æ±‚å¯¼ï¼Œå¾—åˆ°ï¼š</p>
<p>$$ \frac{\partial L}{\partial y_{\text{pred}}} = 2(y_{\text{pred}} - y_{\text{true}}) $$</p>
<ol start="2">
<li><strong>ç¬¬äºŒéƒ¨åˆ†</strong>: è®¡ç®— $\frac{\partial y_{\text{pred}}}{\partial W}$ã€‚</li>
</ol>
<p>ç”±äº $y_{\text{pred}} $= $W \cdot x + b$ï¼Œå¯¹$ W $æ±‚å¯¼ï¼Œå¾—åˆ°ï¼š</p>
<p>$$ \frac{\partial y_{\text{pred}}}{\partial W} = x $$</p>
<h3 id="4">æ­¥éª¤ 4: åˆå¹¶ç»“æœ</h3>
<p>ç°åœ¨å°†ä¸¤éƒ¨åˆ†ç»“æœç»“åˆèµ·æ¥ï¼š</p>
<p>$$ \frac{\partial L}{\partial W} = 2(y_{\text{pred}} - y_{\text{true}}) \cdot x $$</p>
<h3 id="5">æ­¥éª¤ 5: å°†å…·ä½“æ•°å€¼ä»£å…¥</h3>
<p>æ ¹æ®ç»™å®šçš„æ•°å€¼ $x = 2$,$ y_{\text{true}} = 4$, $W = 1$, å’Œ $b = 0.5$ï¼Œæˆ‘ä»¬é¦–å…ˆè®¡ç®—é¢„æµ‹å€¼$y_{\text{pred}}$ï¼š</p>
<p>$$ y_{\text{pred}} = W \cdot x + b = 1 \cdot 2 + 0.5 = 2.5 $$</p>
<p>ç„¶åä»£å…¥åˆ°æ¢¯åº¦å…¬å¼ä¸­ï¼š</p>
<p>$$ \frac{\partial L}{\partial W} = 2(2.5 - 4) \cdot 2 = 2(-1.5) \cdot 2 = -6.0 $$</p>
<p>æ‰€ä»¥ï¼ŒæŸå¤±å‡½æ•°$ L$ å¯¹ $W $çš„åå¯¼æ•°æ˜¯ $-6.0$ã€‚</p>
<p>æ€»ç»“ï¼šå¯¹äºå¤æ‚çš„æ¢¯åº¦è®¡ç®—å¯ä»¥åˆ©ç”¨é“¾å¼æ³•åˆ™ã€‚åœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œå…ˆä»¤ $y_{\text{pred}} $= $W \cdot x + b$ã€‚å¯¹$W$æ±‚åå¯¼ï¼Œå°±å¯ä»¥è½¬åŒ–ä¸ºï¼Œ$\frac{\partial L}{\partial W} = \frac{\partial L}{\partial y_{\text{pred}}} \cdot \frac{\partial y_{\text{pred}}}{\partial W}$ï¼Œç„¶åå¯ä»¥å…ˆæ±‚$\frac{\partial L}{\partial y_{\text{pred}}} $ï¼Œå†æ±‚$\frac{\partial y_{\text{pred}}}{\partial W}$ï¼Œè¿™æ ·è®¡ç®—å°±æ²¡æœ‰è¿™ä¹ˆå¤æ‚äº†ã€‚æ ¹æ®å…¬å¼$\frac{\partial L}{\partial y_{\text{pred}}} = 2(y_{\text{pred}} - y_{\text{true}})$,è€Œ$\frac{\partial y_{\text{pred}}}{\partial W} = x$,æ‰€ä»¥$\frac{\partial L}{\partial W} = 2(y_{\text{pred}} - y_{\text{true}}) \cdot x$ï¼Œå› æ­¤çŸ¥é“é¢„æµ‹å€¼ã€çœŸå®å€¼ã€è¾“å…¥å€¼ã€å½“å‰çš„æƒé‡å’Œåç½®å³å¯ç®—å‡ºåå¯¼ã€‚åŒç†$b$ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼æ–¹æ³•ï¼Œç»§è€Œç®—å‡ºæŸå¤±å‡½æ•°çš„æ¢¯åº¦$\nabla L = \left( \frac{\partial L}{\partial W}, \frac{\partial L}{\partial b} \right)$</p>
<h2 id="pytorch">pytorchç¤ºä¾‹</h2>
<p>åœ¨pytorchä¸­é€šè¿‡è‡ªåŠ¨å¾®åˆ†Autogradè‡ªåŠ¨è®¡ç®—æ¢¯åº¦ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># å®šä¹‰å‚æ•°ï¼ˆå¯ç”¨æ¢¯åº¦è¿½è¸ªï¼‰</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># è¾“å…¥æ•°æ®</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>

<span class="c1"># å‰å‘ä¼ æ’­</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">W</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
<span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">y_true</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c1"># åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦</span>
<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

<span class="c1"># è¾“å‡ºæ¢¯åº¦</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"dL/dW: </span><span class="si">{</span><span class="n">W</span><span class="o">.</span><span class="n">grad</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># è¾“å‡º tensor(-6.0)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"dL/db: </span><span class="si">{</span><span class="n">b</span><span class="o">.</span><span class="n">grad</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># è¾“å‡º tensor(-3.0)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>æ¦‚å¿µ</th>
<th>æ•°å­¦è¡¨è¾¾</th>
<th>æ„ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ¢¯åº¦å®šä¹‰</td>
<td>âˆ‡f = (âˆ‚f/âˆ‚xâ‚, â€¦)</td>
<td>å¤šå…ƒå‡½æ•°å˜åŒ–æœ€å¿«çš„æ–¹å‘åŠå…¶é€Ÿç‡</td>
</tr>
<tr>
<td>æ¢¯åº¦ä¸‹é™</td>
<td>W â† W âˆ’ Î± â‹… âˆ‚L/âˆ‚W</td>
<td>æ²¿è´Ÿæ¢¯åº¦æ–¹å‘æ›´æ–°å‚æ•°ä»¥æœ€å°åŒ–æŸå¤±å‡½æ•°</td>
</tr>
<tr>
<td>PyTorchè‡ªåŠ¨å¾®åˆ†</td>
<td>loss.backward()</td>
<td>é€šè¿‡åå‘ä¼ æ’­è‡ªåŠ¨è®¡ç®—æ‰€æœ‰å‚æ•°çš„æ¢¯åº¦å¹¶å­˜å‚¨åœ¨ .grad ä¸­</td>
</tr>
</tbody>
</table></div>
  <div class="post-nav">
    <a class="prev" href="å±‚ä¸å—.html">â† å±‚ä¸å—</a>
    <a class="next" href="å‰å‘ä¼ æ’­-åå‘ä¼ æ’­å’Œè®¡ç®—å›¾.html">å‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­å’Œè®¡ç®—å›¾ â†’</a>
  </div>
</article>

      </section>

      <aside class="right-panel">
        
      </aside>
    </main>

    <footer class="site-footer">
      <div class="container">Copyright Â©2022-2025 laumy ç‰ˆæƒæ‰€æœ‰</div>
    </footer>

    <script src="assets/site.js"></script>
  </body>
  </html>


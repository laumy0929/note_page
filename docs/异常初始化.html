<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>å¼‚å¸¸åˆå§‹åŒ– - Laumyçš„æŠ€æœ¯æ ˆ</title>
    <link rel="stylesheet" href="assets/style.css">
    <!-- MathJaxæ”¯æŒLaTeXæ•°å­¦å…¬å¼ -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          processEnvironments: true
        },
        options: {
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        }
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="logo" href="./">Laumyçš„æŠ€æœ¯æ ˆ</a>
        <div class="search">
          <input id="search-input" type="text" placeholder="è¾“å…¥å…³é”®è¯å›è½¦æœç´¢">
        </div>
        <div class="theme-toggle" title="åˆ‡æ¢ä¸»é¢˜" id="theme-toggle">â˜¾</div>
        <nav class="top-nav">
          <div class="nav-item"><a href="./">é¦–é¡µ</a></div>
          <div class="nav-item site-link">
            <a href="https://www.laumy.tech" target="_blank" title="è®¿é—®ä¸»ç«™">ä¸»ç«™ç‚¹:www.laumy.tech</a>
          </div>
        </nav>
      </div>
    </header>

    <main class="container layout">
      <aside class="left-nav">
        
        <div class="card">
          <div class="card-title">æ–‡ç« ç›®å½•</div>
          <nav id="toc"><ul><li><a href="#_1">å¼‚å¸¸å¤„ç†æ¦‚è¿°</a><ul></ul></li><li><a href="#_2">å¼‚å¸¸å…¥å£</a><ul></ul></li><li><a href="#_3">å¼‚å¸¸è½¯ä»¶å¤„ç†æµç¨‹</a><ul></ul></li></ul></nav>
        </div>
        
      </aside>

      <section class="content">
        
<article class="card post">
  <h1>å¼‚å¸¸åˆå§‹åŒ–</h1>
  <div class="meta">
    <span class="meta-item">
      <i class="icon">ğŸ•’</i>
      2024-07-07
    </span>
    <span class="meta-item">
      <i class="icon">ğŸ“‚</i>
      risc-v
    </span>
    <span class="meta-item">
      <i class="icon">ğŸ‘¤</i>
      laumy
    </span>
  </div>
  <div class="post-content"><h2 id="_1">å¼‚å¸¸å¤„ç†æ¦‚è¿°</h2>
<p>ç•¥</p>
<h2 id="_2">å¼‚å¸¸å…¥å£</h2>
<div class="codehilite"><pre><span></span><code><span class="n">start_kernel</span>
<span class="w">  </span><span class="nf">trap_init</span><span class="p">();</span>

<span class="kt">void</span><span class="w"> </span><span class="n">__init</span><span class="w"> </span><span class="nf">trap_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Set sup0 scratch register to 0, indicating to exception vector</span>
<span class="cm">     * that we are presently executing in the kernel</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">csr_write</span><span class="p">(</span><span class="n">CSR_SSCRATCH</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Set the exception vector address */</span>
<span class="w">    </span><span class="n">csr_write</span><span class="p">(</span><span class="n">CSR_STVEC</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">handle_exception</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Enable all interrupts */</span>
<span class="n">csr_write</span><span class="p">(</span><span class="n">CSR_SIE</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<span class="n">è®¾ç½®trapçš„å…¥å£å‡½æ•°ä¸ºhandle_exception</span><span class="err">ã€‚</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="_3">å¼‚å¸¸è½¯ä»¶å¤„ç†æµç¨‹</h2>
<div class="codehilite"><pre><span></span><code><span class="n">ENTRY</span><span class="p">(</span><span class="n">handle_exception</span><span class="p">)</span>
<span class="w">    </span><span class="n">SAVE_ALL</span>
<span class="w">    </span><span class="n">â‘ </span><span class="w"> </span><span class="n">ä¿å­˜ä¸Šä¸‹æ–‡</span><span class="err">ï¼Œ</span><span class="n">ä¸»è¦æ˜¯ä¸€äº›å¯„å­˜å™¨</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Set sscratch register to 0, so that if a recursive exception</span>
<span class="cm">     * occurs, the exception vector knows it came from the kernel</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">csrw</span><span class="w"> </span><span class="n">CSR_SSCRATCH</span><span class="p">,</span><span class="w"> </span><span class="n">x0</span>
<span class="w">    </span><span class="n">â‘¡æ¸…ç©ºä¸´æ—¶å¯„å­˜å™¨scratch</span>
<span class="w">    </span><span class="cm">/* Load the global pointer */</span>
<span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="n">push</span>
<span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="n">norelax</span>
<span class="w">    </span><span class="n">la</span><span class="w"> </span><span class="n">gp</span><span class="p">,</span><span class="w"> </span><span class="n">__global_pointer$</span>
<span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="n">pop</span>

<span class="n">la</span><span class="w"> </span><span class="n">ra</span><span class="p">,</span><span class="w"> </span><span class="n">ret_from_exception</span>
<span class="n">â‘¢</span><span class="w"> </span><span class="n">è®¾ç½®å¼‚å¸¸è¿”å›</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * MSB of cause differentiates between</span>
<span class="cm">     * interrupts and exceptions</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">bge</span><span class="w"> </span><span class="n">s4</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="mf">1f</span>

<span class="w">    </span><span class="cm">/* Handle interrupts */</span>
<span class="w">    </span><span class="n">move</span><span class="w"> </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="cm">/* pt_regs */</span>
<span class="n">tail</span><span class="w"> </span><span class="n">do_IRQ</span>
<span class="n">â‘£s4é‡Œé¢ä¿å­˜çš„æ˜¯scauseçš„å€¼</span><span class="err">ï¼Œ</span><span class="n">é€šè¿‡æœ€é«˜ä½åˆ¤æ–­æ˜¯ä¸­æ–­è¿˜æ˜¯å¼‚å¸¸</span><span class="err">ï¼Œ</span><span class="n">ä¸­æ–­è°ƒç”¨do_IRQ</span><span class="err">ï¼Œ</span><span class="n">å¼‚å¸¸çš„å°±æ¥ç€å¾€ä¸‹è¿è¡Œ</span><span class="err">ã€‚</span><span class="n">å…³äºdo_IRQçš„å¤„ç†å¾…åç»­ä¸­æ–­å¤„ç†æµç¨‹å•ç‹¬åˆ†æ</span><span class="err">ã€‚</span>
<span class="mi">1</span><span class="o">:</span>
<span class="w">    </span><span class="cm">/* Exceptions run with interrupts enabled or disabled</span>
<span class="cm">       depending on the state of sstatus.SR_SPIE */</span>
<span class="w">    </span><span class="n">andi</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">SR_SPIE</span>
<span class="w">    </span><span class="n">beqz</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="mf">1f</span>
<span class="w">    </span><span class="n">csrs</span><span class="w"> </span><span class="n">CSR_SSTATUS</span><span class="p">,</span><span class="w"> </span><span class="n">SR_SIE</span>
<span class="mi">1</span><span class="o">:</span>
<span class="w">    </span><span class="cm">/* Handle syscalls */</span>
<span class="w">    </span><span class="n">li</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">EXC_SYSCALL</span>
<span class="w">    </span><span class="n">beq</span><span class="w"> </span><span class="n">s4</span><span class="p">,</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">handle_syscall</span>
<span class="w">    </span><span class="n">â‘£</span><span class="w"> </span><span class="n">å¼‚å¸¸ç±»å‹æ˜¯ç³»ç»Ÿè°ƒç”¨</span><span class="err">ï¼Œ</span><span class="n">åˆ™è·³è½¬handle_syscall</span>
<span class="w">    </span><span class="cm">/* Handle other exceptions */</span>
<span class="w">    </span><span class="n">slli</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">s4</span><span class="p">,</span><span class="w"> </span><span class="n">RISCV_LGPTR</span>
<span class="w">    </span><span class="n">la</span><span class="w"> </span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="n">excp_vect_table</span>
<span class="w">    </span><span class="n">la</span><span class="w"> </span><span class="n">t2</span><span class="p">,</span><span class="w"> </span><span class="n">excp_vect_table_end</span>
<span class="w">    </span><span class="n">move</span><span class="w"> </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="w"> </span><span class="cm">/* pt_regs */</span>
<span class="w">    </span><span class="n">add</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="n">t0</span>
<span class="w">    </span><span class="cm">/* Check if exception code lies within bounds */</span>
<span class="w">    </span><span class="n">bgeu</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">t2</span><span class="p">,</span><span class="w"> </span><span class="mf">1f</span>
<span class="w">    </span><span class="n">REG_L</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">(</span><span class="n">t0</span><span class="p">)</span>
<span class="n">jr</span><span class="w"> </span><span class="n">t0</span>
<span class="n">â‘¤å¦‚æœä¸æ˜¯ç³»ç»Ÿè°ƒç”¨</span><span class="err">ï¼Œ</span><span class="n">å¤„ç†å…¶ä»–ç±»å‹å¼‚å¸¸</span><span class="err">ï¼Œ</span><span class="n">æ ¹æ®excp_vect_tableè¿›è¡Œè·³è½¬</span><span class="err">ï¼Œ</span><span class="n">å¦‚do_page_fault</span>
<span class="mi">1</span><span class="o">:</span>
<span class="w">    </span><span class="n">tail</span><span class="w"> </span><span class="n">do_trap_unknown</span>
<span class="w">    </span><span class="n">â‘¥å¦‚æœä»excp_vect_tableéƒ½æœªæŸ¥è¯¢åˆ°å¯¹åº”çš„å¼‚å¸¸</span><span class="err">ï¼Œ</span><span class="n">è¿›è¡Œå•ç‹¬å¤„ç†</span><span class="err">ã€‚</span>
<span class="nl">handle_syscall</span><span class="p">:</span>
<span class="w">     </span><span class="cm">/* save the initial A0 value (needed in signal handlers) */</span>
<span class="w">    </span><span class="n">REG_S</span><span class="w"> </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">PT_ORIG_A0</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Advance SEPC to avoid executing the original</span>
<span class="cm">     * scall instruction on sret</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">addi</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4</span>
<span class="w">    </span><span class="n">REG_S</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">PT_SEPC</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="w">    </span><span class="cm">/* Trace syscalls, but only if requested by the user. */</span>
<span class="w">    </span><span class="n">REG_L</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">TASK_TI_FLAGS</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
<span class="w">    </span><span class="n">andi</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">_TIF_SYSCALL_WORK</span>
<span class="w">    </span><span class="n">bnez</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">handle_syscall_trace_enter</span>
<span class="nl">check_syscall_nr</span><span class="p">:</span>
<span class="w">    </span><span class="cm">/* Check to make sure we don't jump to a bogus syscall number. */</span>
<span class="w">    </span><span class="n">li</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">__NR_syscalls</span>
<span class="w">    </span><span class="n">la</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">sys_ni_syscall</span>
<span class="w">    </span><span class="cm">/* Syscall number held in a7 */</span>
<span class="w">    </span><span class="n">bgeu</span><span class="w"> </span><span class="n">a7</span><span class="p">,</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="mf">1f</span>
<span class="w">    </span><span class="n">la</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">sys_call_table</span>
<span class="w">    </span><span class="n">slli</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">a7</span><span class="p">,</span><span class="w"> </span><span class="n">RISCV_LGPTR</span>
<span class="w">    </span><span class="n">add</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">t0</span>
<span class="w">    </span><span class="n">REG_L</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">(</span><span class="n">s0</span><span class="p">)</span>
<span class="mi">1</span><span class="o">:</span>
<span class="w">    </span><span class="n">jalr</span><span class="w"> </span><span class="n">s0</span>
<span class="nl">ret_from_syscall</span><span class="p">:</span>
<span class="w">    </span><span class="cm">/* Set user a0 to kernel a0 */</span>
<span class="w">    </span><span class="n">REG_S</span><span class="w"> </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">PT_A0</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="w">    </span><span class="cm">/* Trace syscalls, but only if requested by the user. */</span>
<span class="w">    </span><span class="n">REG_L</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">TASK_TI_FLAGS</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>
<span class="w">    </span><span class="n">andi</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">_TIF_SYSCALL_WORK</span>
<span class="w">    </span><span class="n">bnez</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">handle_syscall_trace_exit</span>
<span class="w">    </span><span class="n">â‘¦ä¸Šé¢æ˜¯ç³»ç»Ÿè°ƒç”¨çš„å¼‚å¸¸å¤„ç†</span><span class="err">ï¼Œ</span><span class="n">åç»­å†å•ç‹¬åˆ†æ</span><span class="err">ã€‚</span>
<span class="nl">ret_from_exception</span><span class="p">:</span>
<span class="w">    </span><span class="n">REG_L</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">PT_SSTATUS</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="w">    </span><span class="n">csrc</span><span class="w"> </span><span class="n">CSR_SSTATUS</span><span class="p">,</span><span class="w"> </span><span class="n">SR_SIE</span>
<span class="w">    </span><span class="n">andi</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">SR_SPP</span>
<span class="w">    </span><span class="n">bnez</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">resume_kernel</span>
<span class="w">    </span><span class="n">â‘§ä»å¼‚å¸¸ä¸­è¿”å›</span><span class="err">ï¼Œ</span><span class="n">æ ¹æ®sstatusä¸­SPPçš„ä½æ¥åˆ¤æ–­æ˜¯å†…æ ¸é™·å…¥çš„å¼‚å¸¸è¿˜æ˜¯ç”¨æˆ·é™·å…¥çš„å¼‚å¸¸</span><span class="err">ï¼Œ</span><span class="mi">0</span><span class="n">æ˜¯ç”¨æˆ·é™·å…¥çš„å¼‚å¸¸</span><span class="err">ï¼Œ</span><span class="n">è·³è½¬æ‰§è¡Œresume_userspace</span><span class="err">ï¼Œ</span><span class="mi">1</span><span class="n">æ˜¯å†…æ ¸é™·å…¥çš„å¼‚å¸¸</span><span class="err">ï¼Œ</span><span class="n">è·³è½¬æ‰§è¡Œresume_kernel</span><span class="err">ã€‚</span><span class="n">sstatus</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="n">æ˜¯SPPä½</span><span class="err">ï¼Œ</span><span class="n">ä¿å­˜çš„æ˜¯é™·å…¥å¼‚å¸¸å‰æ˜¯Uæ¨¡å¼è¿˜æ˜¯Sæ¨¡å¼</span><span class="err">ï¼Œ</span><span class="n">å¦‚æœæ˜¯Uæ¨¡å¼ä»£è¡¨æ˜¯ç”¨æˆ·æ€</span><span class="err">ï¼Œ</span><span class="n">å¦‚æœæ˜¯Sæ¨¡å¼ä»£è¡¨æ˜¯å†…æ ¸æ€</span><span class="err">ã€‚</span>
<span class="nl">resume_userspace</span><span class="p">:</span>
<span class="w">    </span><span class="cm">/* Interrupts must be disabled here so flags are checked atomically */</span>
<span class="w">    </span><span class="n">REG_L</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">TASK_TI_FLAGS</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span><span class="w"> </span><span class="cm">/* current_thread_info-&gt;flags */</span>
<span class="w">    </span><span class="n">andi</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">_TIF_WORK_MASK</span>
<span class="w">    </span><span class="n">bnez</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">work_pending</span>

<span class="w">    </span><span class="cm">/* Save unwound kernel stack pointer in thread_info */</span>
<span class="w">    </span><span class="n">addi</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">sp</span><span class="p">,</span><span class="w"> </span><span class="n">PT_SIZE_ON_STACK</span>
<span class="w">    </span><span class="n">REG_S</span><span class="w"> </span><span class="n">s0</span><span class="p">,</span><span class="w"> </span><span class="n">TASK_TI_KERNEL_SP</span><span class="p">(</span><span class="n">tp</span><span class="p">)</span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Save TP into sscratch, so we can find the kernel data structures</span>
<span class="cm">     * again.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">csrw</span><span class="w"> </span><span class="n">CSR_SSCRATCH</span><span class="p">,</span><span class="w"> </span><span class="n">tp</span>
<span class="w">    </span><span class="n">â‘¨</span><span class="w"> </span><span class="n">æ¢å¤ç”¨æˆ·æ€çš„tp</span><span class="err">ï¼Œ</span><span class="n">çº¿ç¨‹æŒ‡é’ˆ</span><span class="err">ï¼Œ</span><span class="n">å¾…åˆ°åç»­è¿›ç¨‹è°ƒåº¦æ—¶å†è¯¦ç»†åˆ†æ</span><span class="err">ã€‚</span>
<span class="nl">restore_all</span><span class="p">:</span>
<span class="w">    </span><span class="n">RESTORE_ALL</span>
<span class="n">sret</span>
<span class="n">â‘©</span><span class="w"> </span><span class="n">æ¢å¤ä¸Šä¸‹æ–‡</span><span class="err">ï¼Œ</span><span class="n">æ‰§è¡Œsretè¿”å›</span><span class="err">ã€‚</span>
</code></pre></div>
<p>arch/riscv/kernel/entry.Sæ˜¯å…³äºrisc-v trapå…¥å£çš„å®ç°ï¼Œtrapçš„åŒ…å«å¼‚å¸¸å’Œä¸­æ–­ã€‚trapçš„ä¸­æ€»å…¥å£ä¸ºhandle_exceptionï¼Œä¸»è¦å¤„ç†ä¸€ä¸‹äº‹é¡¹ã€‚ - ä¿å­˜ä¸Šä¸‹æ–‡ï¼Œä¸»è¦æ˜¯å°†ä¸€äº›å¯„å­˜å™¨å‹å…¥æ ˆä¸­ã€‚ - æ ¹æ®scauseå¯„å­˜å™¨åˆ¤æ–­æ˜¯å¼‚å¸¸è¿˜æ˜¯ä¸­æ–­ï¼Œå¦‚æœæ˜¯ä¸­æ–­è·³è½¬åˆ°do_IRQè¿è¡Œï¼Œå¦‚æœæ˜¯å¼‚å¸¸æ ¹æ®å¼‚å¸¸çš„causeè¿›åˆ†å‘å¤„ç†ã€‚ - å¼‚å¸¸ä¸­æœ‰ä¸€ç±»æ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œæ ¹æ®scauseæŸ¥è¯¢å¦‚æœæ˜¯ç³»ç»Ÿè°ƒç”¨æ ¹æ®sys_call_table[]è·³è½¬å¤„ç†ã€‚ - å¼‚å¸¸å¦‚æœä¸æ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œå°±æ˜¯ç¨‹åºè¿è¡Œä¸­å‡ºç°çš„å¼‚å¸¸ï¼Œæ ¹æ®scauseæŸ¥è¯¢excp_vect_table[]è·³è½¬å¤„ç†ã€‚ - å¼‚å¸¸å’Œä¸­æ–­éƒ½å¤„ç†å®Œæˆä¹‹åï¼Œæœ€ç»ˆå›åˆ°ret_from_exceptionï¼Œè¿™é‡Œä¼šæ ¹æ®sstatusçš„SSPä½æ¥åˆ¤æ–­æ˜¯ç”¨æˆ·æ€é™·å…¥çš„è¿˜æ˜¯å†…æ ¸æ€é™·å…¥ï¼Œæ ¹æ®å†…æ ¸å’Œç”¨æˆ·æ€çš„æ›´æ–°tpã€‚ - æœ€åè°ƒç”¨RESTORE_ALLæ¢å¤ä¸Šä¸‹æ–‡ï¼Œé€€å‡ºtrapã€‚</p></div>
  <div class="post-nav">
    <a class="prev" href="è™šæ‹Ÿåœ°å€ç©ºé—´ä¸ç‰©ç†åœ°å€ç©ºé—´å®Œæ•´æ˜ å°„.html">â† è™šæ‹Ÿåœ°å€ç©ºé—´ä¸ç‰©ç†åœ°å€ç©ºé—´å®Œæ•´æ˜ å°„</a>
    <a class="next" href="æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ.html">æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ â†’</a>
  </div>
</article>

      </section>

      <aside class="right-panel">
        
      </aside>
    </main>

    <footer class="site-footer">
      <div class="container">Copyright Â©2022-2025 laumy ç‰ˆæƒæ‰€æœ‰</div>
    </footer>

    <script src="assets/site.js"></script>
  </body>
  </html>

